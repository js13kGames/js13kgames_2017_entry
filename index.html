<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">body,html{background-color:#000;height:100%;margin:0;padding:0;width:100%}#canvas{background-color:inherit;border-radius:235px;margin:50px 0 0 -224px}#canvas,.speech{left:50%;position:fixed;z-index:100}.speech{font-family:Arial,"serif";line-height:36px;font-size:24px;padding:0;top:408px}#dialogue{color:#fff;height:324px;margin:112px 0 0 -190px;width:600px}#speaker{color:#ff0;height:50px;margin:112px 0 0 -425px;text-align:right;width:200px}</style></head>

<body>
    <canvas id="canvas"></canvas>

    <div id="dialogue" class="speech"></div>

    <div id="speaker" class="speech"></div>
<script type="text/javascript">!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return l});var r=n(16),o=n(17),a=n(18),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u={},h=window.location.href.replace("index.html","")+"src/res/",l=function(){function e(t,n,r,s){i(this,e),u[t]=this,this.name=t,this.path=n,this.width=r,this.height=s,this.sheet=new a.a(o.a.loadImage(this.path)),this.animations={}}return s(e,[{key:"addAnimation",value:function(e,t){this.animations[e]=t}},{key:"getWidth",value:function(){return 16}},{key:"getHeight",value:function(){return 16}}],[{key:"getAssets",value:function(e){return u[e]}}]),e}(),c=function(e,t,n){return e.sheet.crop(16*t,16*n,16,16)},f=new l("tiles",h+"tiles.png",16,16);f.path=c(f,1,0),f.pathBlue=c(f,1,2),f.pathGreen=c(f,2,2),f.pathYellow=c(f,0,2),f.wall=c(f,0,0),f.wallBlue=c(f,1,1),f.wallGreen=c(f,2,1),f.wallYellow=c(f,0,1),f.switchGreen=c(f,2,0),f.switchBlue=c(f,3,0),f.exit=c(f,3,1),f.lantern=c(f,3,2);var p=new l("sprites",h+"sprites.png",16,18),y=new l("creature",h+"creature.png",16,18),d=function(e){for(var t=[],n=[],i=[],o=[],a=[],s=0;s<3;s++)i.push({frame:e.sheet.crop(e.width*s,0*e.height,e.width,e.height),speed:200}),t.push({frame:e.sheet.crop(e.width*s,1*e.height+1,e.width,e.height),speed:200}),o.push({frame:e.sheet.crop(e.width*s,2*e.height+1,e.width,e.height),speed:200}),n.push({frame:e.sheet.crop(e.width*s,3*e.height+1,e.width,e.height),speed:200}),a.push({frame:e.sheet.crop(e.width*s,4*e.height,e.width,e.height),speed:500});var u=[{frame:e.sheet.crop(0,2*e.height,e.width,e.height),speed:200},{frame:e.sheet.crop(1*e.width,2*e.height,e.width,e.height),speed:200},{frame:e.sheet.crop(2*e.width,2*e.height,e.width,e.height),speed:200}];e.addAnimation("walk_up",new r.a(i)),e.addAnimation("walk_right",new r.a(t)),e.addAnimation("walk_down",new r.a(o)),e.addAnimation("walk_left",new r.a(n)),e.addAnimation("idle",new r.a(u)),e.addAnimation("death",new r.a(a))};d(p),d(y)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return a});var r=n(0),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t,n){i(this,e),this.isSolid=!1,this.texture=t,this.id=n,this.disappear=!1,this.assets=r.a.getAssets("tiles")}return o(e,[{key:"render",value:function(e,t,n){e.myDrawImage(this.texture,t,n,TILE_WIDTH,TILE_HEIGHT)}},{key:"getId",value:function(){return this.id}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){i(this,e)}return r(e,[{key:"getText",value:function(){return this.text}},{key:"setText",value:function(e){this.text=e}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,n,r,o){i(this,e),this.x=t,this.y=n,this.width=r,this.height=o}return r(e,[{key:"intersects",value:function(e){return this.x<e.x+e.width&&this.x+this.width>e.x&&this.y<e.y+e.height&&this.y+this.height>e.y}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return s});var a=n(8),s=function(e){function t(e,n,o,a,s){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,a,s))}return o(t,e),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this.handler=t,this.countSinceInput=0}return r(e,[{key:"tick",value:function(e){this.countSinceInput++,this.countSinceInput>8&&this.getInput(e),this.render()}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return a});var r=n(13),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t){i(this,e),this.handler=t,this.world=new r.a(t)}return o(e,[{key:"tick",value:function(e){this.world.tick(e)}},{key:"render",value:function(e){this.world.render(e)}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return h});var a=n(8),s=n(3),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=function(e){function t(e,n,o){i(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,64,64));return a.speed=80,a.xMove=0,a.yMove=0,a}return o(t,e),u(t,[{key:"tick",value:function(){this.yMove<0&&this.assets.animations.walk_up.tick(),this.yMove>0&&this.assets.animations.walk_down.tick(),this.xMove>0&&this.assets.animations.walk_right.tick(),this.xMove<0&&this.assets.animations.walk_left.tick()}},{key:"move",value:function(){(Math.abs(this.xMove)>0||Math.abs(this.yMove)>0)&&(this.handler.getWorld().getSpatialGrid().remove(new s.a(this.x+this.bounds.x,this.y+this.bounds.y,this.bounds.width,this.bounds.height),this),this.checkEntityCollisions(this.xMove,0)||this.moveX(),this.checkEntityCollisions(0,this.yMove)||this.moveY(),this.handler.getWorld().getSpatialGrid().insert(new s.a(this.x+this.bounds.x,this.y+this.bounds.y,this.bounds.width,this.bounds.height),this))}},{key:"moveX",value:function(){if(this.clipping)return void(this.x+=this.xMove);var e=this.xMove>0?parseInt((this.x+this.xMove+this.bounds.x+this.bounds.width)/TILE_WIDTH):parseInt((this.x+this.xMove+this.bounds.x)/TILE_WIDTH),t=parseInt((this.y+this.bounds.y)/TILE_HEIGHT),n=parseInt((this.y+this.bounds.y+this.bounds.height)/TILE_HEIGHT),i=this.xMove>0?e*TILE_WIDTH-this.bounds.x-this.bounds.width-1:e*TILE_WIDTH+TILE_WIDTH-this.bounds.x;this.collisionWithTile(e,t)||this.collisionWithTile(e,n)?this.x=i:this.x+=this.xMove}},{key:"moveY",value:function(){if(this.clipping)return void(this.y+=this.yMove);var e=this.yMove>0?parseInt((this.y+this.yMove+this.bounds.y+this.bounds.height)/TILE_HEIGHT):parseInt((this.y+this.yMove+this.bounds.y)/TILE_HEIGHT),t=parseInt((this.x+this.bounds.x)/TILE_WIDTH),n=parseInt((this.x+this.bounds.x+this.bounds.width)/TILE_WIDTH),i=this.yMove>0?e*TILE_HEIGHT-this.bounds.y-this.bounds.height-1:e*TILE_HEIGHT+TILE_HEIGHT-this.bounds.y;this.collisionWithTile(t,e)||this.collisionWithTile(n,e)?this.y=i:this.y+=this.yMove}},{key:"collisionWithTile",value:function(e,t){try{return this.handler.getWorld().getTile(e,t).isSolid}catch(e){}}},{key:"getCurrentAnimationFrame",value:function(){return this.xMove<0?(this.lastAnimation="walk_left",this.assets.animations.walk_left.getCurrentFrame()):this.xMove>0?(this.lastAnimation="walk_right",this.assets.animations.walk_right.getCurrentFrame()):this.yMove<0?(this.lastAnimation="walk_up",this.assets.animations.walk_up.getCurrentFrame()):this.yMove>0?(this.lastAnimation="walk_down",this.assets.animations.walk_down.getCurrentFrame()):this.assets.animations[this.lastAnimation].getCurrentFrame()}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return u});var r=n(19),o=n(20),a=n(3),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(){function e(t,n,r,o,s){i(this,e),this.x=n,this.y=r,this.width=o,this.height=s,this.handler=t,this.bounds=new a.a(0,0,o,s),this.moveThrough=!1}return s(e,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getCollisionBounds",value:function(e,t){return new a.a(parseInt(this.x+this.bounds.x+e),parseInt(this.y+this.bounds.y+t),this.bounds.width,this.bounds.height)}},{key:"checkEntityCollisions",value:function(e,t){for(var n=this.handler.getWorld().getSpatialGrid().retrieve(new a.a(this.x+this.bounds.x+e,this.y+this.bounds.y+t,this.bounds.width,this.bounds.height),this),i=0;i<n.length;i++){var r=n[i];if(r.moveThrough)return!1;if(r.getCollisionBounds(0,0).intersects(this.getCollisionBounds(e,t)))return this.checkForCollisionEvents(this,r),!0}return!1}},{key:"checkForCollisionEvents",value:function(e,t){if(!this.checkCollidingTypes(e,t,"monster","monster")){var n=this.handler,i=n.getGame(),a=n.getWorld(),s=a.entityManager;if(this.checkCollidingTypes(e,t,"player","journal")&&("journal"===e.type?(e.triggerEntry(),s.removeEntity(e)):(t.triggerEntry(),s.removeEntity(t))),this.checkCollidingTypes(e,t,"switch","player")&&("switch"===e.type?e.toggleSwitch():t.toggleSwitch()),this.checkCollidingTypes(e,t,"player","exit")){if(a.level>=4){a.dialogue.clear();var u=new r.a(this.handler);i.getGameState().setState(u)}return void a.changeLevel()}if(this.checkCollidingTypes(e,t,"player","monster")){if(e.invincible||t.invincible)return;a.dialogue.clear();var h=new o.a(e.handler);i.getGameState().setState(h)}}}},{key:"checkCollidingTypes",value:function(e,t,n,i){return e.type===n&&t.type===i||e.type===i&&t.type===n}},{key:"setX",value:function(e){this.x=e}},{key:"setY",value:function(e){this.y=e}},{key:"setWidth",value:function(e){this.width=e}},{key:"setHeight",value:function(e){this.height=e}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(n(10),n(53));n.n(i)},function(e,t,n){"use strict";var i=n(11);window.TILE_HEIGHT=64,window.TILE_WIDTH=64,window.DEFAULT_LIGHT=.85,window.CENTER_LIGHT=.3,window.INNER_LIGHT=.5,window.OUTER_LIGHT=.65,new i.a("Lost!",448,448).start()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return w});var r=n(12),o=n(6),a=n(46),s=n(47),u=n(48),h=(n(49),n(50)),l=(n(51),function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}()),c=!1,f=void 0,p=void 0,y=void 0,d=void 0,g=void 0,v=void 0,b=void 0,w=function(){function e(t,n,r){i(this,e),this.height=r,this.title=t,this.width=n}return l(e,[{key:"run",value:function(){var e=this;this.init();var t=0,n=0,i=Date.now(),r=Date.now(),o=0;!function a(){c&&(i=Date.now(),t=i-r,o+=t,r=i),o>=1e3/60&&(n=o/1e3,e.tick(n),e.render(),o=0),window.requestAnimationFrame(a)}()}},{key:"start",value:function(){c||(c=!0,this.run())}},{key:"getSoundManager",value:function(){}},{key:"getKeyManager",value:function(){return y}},{key:"getDisplay",value:function(){return p}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getGameCamera",value:function(){return g}},{key:"getGameState",value:function(){return v}},{key:"init",value:function(){d=new s.a(this),p=new r.a(this.title,this.width,this.height),y=new u.a,f=p.getGraphics(),v=new h.a,g=new a.a(d,0,0),b=new o.a(d),v.setState(b)}},{key:"tick",value:function(e){y.tick(),v.getState()&&!p.paused&&v.getState().tick(e)}},{key:"render",value:function(){v.getState()&&!p.paused&&v.getState().render(f)}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return a});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=null,a=function(){function e(t,n,r){i(this,e),this.title=t,this.width=n,this.height=r,this.paused=!1,this.createDisplay()}return r(e,[{key:"createDisplay",value:function(){document.title=this.title;var e=document.getElementById("canvas");e.setAttribute("height",this.height),e.setAttribute("width",this.width),o=e.getContext("2d"),o.webkitImageSmoothingEnabled=!1,o.mozImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1,this.setEventListeners()}},{key:"setEventListeners",value:function(){window.onblur=this.pause,window.onfocus=this.unPause}},{key:"pause",value:function(){this.paused=!0}},{key:"unPause",value:function(){this.paused=!1}},{key:"getTitle",value:function(){return this.title}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getGraphics",value:function(){return o}}]),e}();CanvasRenderingContext2D.prototype.myDrawImage=function(e,t,n,i,r){o.drawImage(e.sheet,e.x,e.y,e.width,e.height,t,n,i,r)},CanvasRenderingContext2D.prototype.drawText=function(e){o.font=e.fontSize+"px Arial",o.fillStyle=e.fillColor,o.strokeText(e.text,e.x,e.y),o.fillText(e.text,e.x,e.y)}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return x});var r=n(14),o=n(15),a=n(21),s=n(22),u=n(23),h=n(24),l=n(33),c=n(35),f=n(36),p=n(37),y=n(38),d=n(39),g=n(40),v=n(41),b=n(42),w=n(43),m=n(44),T=n(45),k=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),_=!1,E=!1,O=0,I=0,x=function(){function e(t){i(this,e),this.width=null,this.height=null,this.tiles=[],this.handler=t,t.setWorld(this),this.entityManager=new r.a(t,new s.a(t,20,20)),this.spatialGrid=new u.a(this.handler.getWidth()*TILE_WIDTH,this.handler.getHeight()*TILE_HEIGHT,64),this.level=1,this.loadWorld(),this.lightManager=new l.a(t),this.dialogue=new p.a,this.init()}return k(e,[{key:"getLightManager",value:function(){return this.lightManager}},{key:"changeLevel",value:function(){this.setPlayerSpawn(this.spawnX,this.spawnY),this.level+=1,this.tiles=[],I=0,this.lightManager.removeSources(),this.entityManager.removeEntitiesByType("exit"),this.entityManager.removeEntitiesByType("switch"),this.entityManager.removeEntitiesByType("journal"),E||this.entityManager.removeEntitiesByType("monster"),E=!1,this.loadWorld(),this.init()}},{key:"spawnRandomRoomEntities",value:function(){var e=new c.a(this.handler,(this.width-2)*TILE_WIDTH,(this.height-2)*TILE_HEIGHT,TILE_WIDTH,TILE_HEIGHT),t=Math.random()<.5,n=t?(this.width-3)*TILE_WIDTH:2*TILE_WIDTH,i=t?2*TILE_HEIGHT:(this.height-3)*TILE_HEIGHT;this.entityManager.addEntity(new f.a(this.handler,n,i,TILE_WIDTH,TILE_HEIGHT)),this.entityManager.addEntity(e)}},{key:"init",value:function(){this.setPlayerSpawn(this.spawnX,this.spawnY),this.lightManager.init(),this.lightManager.fillLightMap(),1===this.level?(this.entityManager.addEntity(new c.a(this.handler,7*TILE_WIDTH,7*TILE_HEIGHT,TILE_WIDTH,TILE_HEIGHT)),this.entityManager.addEntity(new y.a(this.handler,1*TILE_WIDTH,2*TILE_HEIGHT,TILE_WIDTH,TILE_HEIGHT,new d.a)),this.entityManager.addEntity(new o.a(this.handler,6*TILE_WIDTH,2*TILE_WIDTH)),this.entityManager.addEntity(new f.a(this.handler,4*TILE_WIDTH,4*TILE_HEIGHT,TILE_WIDTH,TILE_HEIGHT)),this.lightManager.addSource(5,3)):(this.spawnRandomRoomEntities(),this.addEvenSpreadOfLightSources(7),this.addEvenSpreadOfMonsters(7),this.spawnJournals())}},{key:"spawnJournals",value:function(){var e=[new g.a,new v.a,new b.a,new w.a,new m.a,new T.a],t=e[2*this.level-4],n=e[2*this.level-3];this.entityManager.addEntity(new y.a(this.handler,2*TILE_WIDTH,2*TILE_HEIGHT,TILE_WIDTH,TILE_HEIGHT,t)),this.entityManager.addEntity(new y.a(this.handler,(this.width-3)*TILE_WIDTH,(this.height-3)*TILE_HEIGHT,TILE_WIDTH,TILE_HEIGHT,n))}},{key:"addEvenSpreadOfLightSources",value:function(e){for(var t=e;t<=this.height;t+=e)for(var n=e;n<=this.width;n+=e)this.height-t>2&&this.width-n>2&&this.lightManager.addSource(n,t)}},{key:"getWorldHeight",value:function(){return this.height}},{key:"getWorldWidth",value:function(){return this.width}},{key:"addEvenSpreadOfMonsters",value:function(e){for(var t=e;t<=this.height;t+=e)for(var n=e;n<=this.width;n+=e)this.height-t>2&&this.width-n>2&&this.entityManager.addEntity(new o.a(this.handler,n*TILE_WIDTH,t*TILE_WIDTH))}},{key:"setPlayerSpawn",value:function(e,t){this.entityManager.getPlayer().setX(e),this.entityManager.getPlayer().setY(t)}},{key:"loadWorld",value:function(){for(var e=this.fillWorld(this.level,1,1),t=0;t<this.height;t++)for(var n=0;n<this.width;n++)this.tiles[n]||(this.tiles[n]=[]),this.tiles[n][t]=e[n][t]}},{key:"fillWorld",value:function(e,t,n){var i=a.a.getRandomMaze(e,t,n);return this.height=i.mazeHeight,this.width=i.mazeWidth,this.spawnX=i.spawnX*TILE_WIDTH,this.spawnY=i.spawnY*TILE_HEIGHT,i.pieces}},{key:"swapGreenAndBlueTiles",value:function(e){"green"===e?(this.swapTilesByID(5,3),this.swapTilesByID(8,7)):"blue"===e&&(this.swapTilesByID(3,5),this.swapTilesByID(7,8))}},{key:"getInput",value:function(){}},{key:"swapTilesByID",value:function(e,t){for(var n=1;n<this.height;n++)for(var i=1;i<this.width;i++)this.tiles[i][n]===e&&(this.tiles[i][n]=this.handler.getWorld().getTile(i,n).disappear?0:t)}},{key:"checkForWallSwap",value:function(){++O>300&&(O=0,_?this.swapTilesByID(4,2):this.swapTilesByID(2,4),_=!_)}},{key:"tick",value:function(e){this.getInput(),this.checkForWallSwap(),this.entityManager.tick(e),this.lightManager.tick(e),this.dialogue.tick(),E||1===this.level||++I/60>=240&&(alert("the monsters crumble all around you."),this.entityManager.removeEntitiesByType("monster"),E=!0)}},{key:"render",value:function(e){var t=parseInt(Math.max(0,this.handler.getGameCamera().getxOffset()/TILE_WIDTH)),n=parseInt(Math.min(this.width,(this.handler.getGameCamera().getxOffset()+this.handler.getWidth())/TILE_WIDTH+1)),i=parseInt(Math.max(0,this.handler.getGameCamera().getyOffset()/TILE_HEIGHT)),r=parseInt(Math.min(this.height,(this.handler.getGameCamera().getyOffset()+this.handler.getHeight())/TILE_HEIGHT+1));this.drawTiles(t,n,i,r,e),this.entityManager.render(e),this.lightManager.render(t,n,i,r,e)}},{key:"drawTiles",value:function(e,t,n,i,r){for(var o=n;o<i;o++)for(var a=e;a<t;a++)void 0!==this.getTile(a,o)&&this.getTile(a,o).render(r,a*TILE_WIDTH-this.handler.getGameCamera().getxOffset(),o*TILE_HEIGHT-this.handler.getGameCamera().getyOffset())}},{key:"getTile",value:function(e,t){try{return h.a.getTiles()[this.tiles[e][t]]}catch(e){}}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getEntityManager",value:function(){return this.entityManager}},{key:"getSpatialGrid",value:function(){return this.spatialGrid}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return l});var r=n(3),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=void 0,s=void 0,u=void 0,h=function(e,t){var n=e.getY(),i=t.getY(),r=e.getHeight(),o=t.getHeight();return n+r===i+o?0:n+r<i+o?-1:1},l=function(){function e(t,n){i(this,e),a=t,s=n,u=new Array(s)}return o(e,[{key:"tick",value:function(e){u.sort(h);for(var t=0;t<u.length;t++){u[t].tick(e)}}},{key:"render",value:function(e){u.forEach(function(t){t.handler.getWidth()+t.handler.getGameCamera().getxOffset()&&t.handler.getHeight()+t.handler.getGameCamera().getyOffset()&&t.handler.getGameCamera().getxOffset()-t.width&&t.handler.getGameCamera().getyOffset()-t.height&&t.render(e)})}},{key:"getPlayer",value:function(){return s}},{key:"getHandler",value:function(){return a}},{key:"getEntities",value:function(){return u}},{key:"addEntity",value:function(e){u.push(e),a.getWorld().getSpatialGrid().insert(new r.a(e.x+e.bounds.x,e.y+e.bounds.y,e.bounds.width,e.bounds.height),e)}},{key:"removeEntity",value:function(e){var t=u.indexOf(e);a.getWorld().getSpatialGrid().remove(new r.a(e.x+e.bounds.x,e.y+e.bounds.y,e.bounds.width,e.bounds.height),e),u.splice(t,1)}},{key:"removeEntitiesByType",value:function(e){u=u.filter(function(t){if(t.type!==e)return t;a.getWorld().getSpatialGrid().remove(new r.a(t.x+t.bounds.x,t.y+t.bounds.y,t.bounds.width,t.bounds.height),t)})}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return l});var a=n(0),s=n(7),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=function(e){function t(e,n,o){i(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,TILE_WIDTH,TILE_HEIGHT));return s.assets=a.a.getAssets("creature"),s.x=n,s.y=o,s.spawnX=n,s.spawnY=o,s.bounds.x=10,s.bounds.y=10,s.bounds.width=TILE_WIDTH-2*s.bounds.x,s.bounds.height=TILE_HEIGHT-2*s.bounds.y,s.type="monster",s.patrol=s.getPatrolPattern(),s.patrolLength=100,s.dirMoving=0,s.numberOfMoves=0,s.lastAnimation="walk_down",s}return o(t,e),u(t,[{key:"getPatrolPattern",value:function(){var e=["vertical","horizontal"];return e[Math.floor(Math.random()*e.length)]}},{key:"maybeChangePatrol",value:function(){Math.random()<.41&&(this.patrol="vertical"===this.patrol?"horizontal":"vertical")}},{key:"checkIfOffMap",value:function(){var e=this.handler.getWorld().getWorldWidth()*TILE_WIDTH,t=this.handler.getWorld().getWorldHeight()*TILE_HEIGHT;(this.x<1||this.y<1||this.x>e||this.y>t)&&(this.x=this.spawnX,this.y=this.spawnY)}},{key:"setPatrolMovement",value:function(e){"vertical"===this.patrol?(0===this.dirMoving?this.yMove=-this.speed*e:this.yMove=this.speed*e,++this.numberOfMoves>this.patrolLength&&(this.dirMoving=0===this.dirMoving?1:0,this.numberOfMoves=0,this.maybeChangePatrol())):"horizontal"===this.patrol&&(0===this.dirMoving?this.xMove=-this.speed*e:this.xMove=this.speed*e,++this.numberOfMoves>this.patrolLength&&(this.dirMoving=0===this.dirMoving?1:0,this.numberOfMoves=0,this.maybeChangePatrol()))}},{key:"checkIfInWall",value:function(){var e=Math.round(this.x/TILE_WIDTH),t=Math.round(this.y/TILE_HEIGHT);if(this.handler.getWorld().getTile(e,t).isSolid)for(var n=e-1,i=t-1,r=e+1,o=t+1,a=i;a<o;a++)for(var s=n;s<r;s++)if(!this.handler.getWorld().getTile(s,a).isSolid&&(s===e||a===t))return this.x=s*TILE_WIDTH,void(this.y=a*TILE_HEIGHT)}},{key:"tick",value:function(e){this.checkIfOffMap(),this.checkIfInWall(),this.setPatrolMovement(e),h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"tick",this).call(this),this.move()}},{key:"render",value:function(e){e.myDrawImage(this.getCurrentAnimationFrame(),this.x-this.handler.getGameCamera().getxOffset(),this.y-this.handler.getGameCamera().getyOffset(),this.width,this.height)}}]),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this.frames=t,this.index=0,this.lastTime=Date.now(),this.timer=0,this.speed=1e3}return r(e,[{key:"tick",value:function(){this.timer+=Date.now()-this.lastTime,this.lastTime=Date.now(),this.timer>=this.speed&&(this.index++,this.timer=0,this.index>=this.frames.length&&(this.index=0))}},{key:"getCurrentFrame",value:function(){return this.speed=this.frames[this.index].speed,this.frames[this.index].frame}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){i(this,e)}return r(e,null,[{key:"loadImage",value:function(e){var t=new Image;return t.src=e,t}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this.sheet=t}return r(e,[{key:"crop",value:function(e,t,n,i){return{sheet:this.sheet,x:e,y:t,width:n,height:i}}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(5),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(e){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),s(t,[{key:"render",value:function(e){if(e){var t=this.handler.getWidth(),n=this.handler.getHeight();e.fillStyle="black",e.fillRect(0,0,t,n);var i="You escaped the maze!",r=t/2-e.measureText(i).width/2,o=n/3;e.drawText({fillColor:"yellow",text:i,fontSize:32,x:r,y:o}),i="Press enter for another run!",r=t/2-e.measureText(i).width/2,o=n/1.5,e.drawText({fillColor:"white",text:i,fontSize:32,x:r,y:o})}}},{key:"getInput",value:function(){this.handler.getKeyManager().enter&&window.location.reload()}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(5),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(e){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),s(t,[{key:"render",value:function(e){if(e){var t=this.handler.getWidth(),n=this.handler.getHeight();e.fillStyle="black",e.fillRect(0,0,t,n);var i="Y O U   D I E D",r=t/2-e.measureText(i).width/2,o=n/3;e.drawText({fillColor:"red",text:i,fontSize:32,x:r,y:o}),i="press enter to try again",r=t/2-e.measureText(i).width/2,o=n/1.5,e.drawText({fillColor:"white",text:i,fontSize:32,x:r,y:o})}}},{key:"getInput",value:function(){this.handler.getKeyManager().enter&&window.location.reload()}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return l});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=[],a=[],s=0,u=0,h=function(e,t){return 0===e||0===t||e===s-1||t===u-1?1:Math.floor(20*Math.random())<15?1:wallIDs[Math.floor(Math.random()*wallIDs.length)]},l=function(){function e(){i(this,e)}return r(e,null,[{key:"createMaze",value:function(){for(var e=[],t=0;t<u;t++){o[t]=[];for(var n=0;n<s;n++)o[t][n]=1}var i=1,r=1;o[i][r]=0,e.push(r+r*s);do{if(e.length){var a="";if(i+2>0&&i+2<u-1&&1==o[i+2][r]&&(a+="S"),i-2>0&&i-2<u-1&&1==o[i-2][r]&&(a+="N"),r-2>0&&r-2<s-1&&1==o[i][r-2]&&(a+="W"),r+2>0&&r+2<s-1&&1==o[i][r+2]&&(a+="E"),a){var h=Math.floor(Math.random()*a.length);switch(a[h]){case"N":o[i-2][r]=0,o[i-1][r]=0,i-=2;break;case"S":o[i+2][r]=0,o[i+1][r]=0,i+=2;break;case"W":o[i][r-2]=0,o[i][r-1]=0,r-=2;break;case"E":o[i][r+2]=0,o[i][r+1]=0,r+=2}e.push(r+i*s)}else{var l=e.pop();i=Math.floor(l/s),r=l%s}this.buildFinalMaze(i,r)}}while(e.length)}},{key:"buildFinalMaze",value:function(){for(var e=0;e<u;e++)for(var t=0;t<s;t++)a[t]||(a[t]=[]),a[t][e]=1===o[e][t]?h(e,t):0}},{key:"createRooms",value:function(){this.createRoom(1,1,3),this.createRoom(1,u-4,3),this.createRoom(s-4,u-4,3),this.createRoom(s-4,1,3)}},{key:"createRoom",value:function(e,t,n){for(var i=t;i<t+n;i++)for(var r=e;r<e+n;r++)a[r][i]=0}},{key:"createBarriers",value:function(e){2!==e&&(a[1][Math.ceil(u/2)]=1,a[1][Math.ceil(u/2)+1]=1,a[s-2][Math.ceil(u/2)]=1,a[s-2][Math.ceil(u/2)+1]=1,a[Math.ceil(s/2)][1]=1,a[Math.ceil(s/2)+1][1]=1,a[Math.ceil(s/2)][u-2]=1,a[Math.ceil(s/2)+1][u-2]=1)}},{key:"getIntroMaze",value:function(){return[[1,1,1,1,1,1,1,1,1],[1,0,0,2,0,0,7,0,1],[1,2,2,2,0,0,7,0,1],[1,0,0,0,0,0,7,0,1],[1,0,0,0,0,0,7,0,1],[1,3,3,0,0,0,7,0,1],[1,0,0,3,0,0,7,0,1],[1,0,0,3,0,0,7,0,1],[1,1,1,1,1,1,1,1,1]]}},{key:"getRandomMaze",value:function(e,t,n){return 1===e?{mazeWidth:9,mazeHeight:9,spawnX:1,spawnY:1,pieces:this.getIntroMaze()}:(s=u=10*e-1,this.createMaze(),this.createRooms(),this.createBarriers(e),{mazeWidth:s,mazeHeight:u,spawnX:t,spawnY:n,pieces:a})}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return f});var a=n(0),s=n(7),u=(n(3),function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}()),h=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=!1,c=0,f=function(e){function t(e,n,o){i(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o));return s.assets=a.a.getAssets("sprites"),s.x=n,s.y=o,s.speed=140,s.bounds.x=14,s.bounds.y=24,s.bounds.width=36,s.bounds.height=39,s.type="player",s.clipping=!1,s.invincible=!1,s.superSpeed=!1,s.allCheats=!1,s.lastAnimation="walk_down",s}return o(t,e),u(t,[{key:"tick",value:function(e){this.xMove=this.yMove=0,this.getInput(e),h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"tick",this).call(this,e),this.move(),this.superSpeed&&(this.move(),this.move()),this.handler.getGameCamera().centerOnEntity(this)}},{key:"render",value:function(e){e.myDrawImage(this.getCurrentAnimationFrame(),this.x-this.handler.getGameCamera().getxOffset(),this.y-this.handler.getGameCamera().getyOffset(),TILE_WIDTH,TILE_HEIGHT)}},{key:"getInput",value:function(e){var t=this.handler.getKeyManager();if((t.up||t.w||t.z)&&(this.yMove=-this.speed*e),(t.down||t.s)&&(this.yMove=this.speed*e),(t.left||t.a||t.q)&&(this.xMove=-this.speed*e),(t.right||t.d)&&(this.xMove=this.speed*e),l||c++,c>15||l){if(l=!0,c=0,t.one){var n=this.allCheats?" ALL CHEATS disabled ":" ALL CHEATS enabled ";this.handler.devMessage(n),this.allCheats=!this.allCheats,this.clipping=this.allCheats,this.invincible=this.allCheats,this.superSpeed=this.allCheats,l=!1}if(t.three){var i=this.invincible?" invincibility disabled ":" invincibility enabled ";this.handler.devMessage(i),this.invincible=!this.invincible,l=!1}if(t.two){var r=this.clipping?" clipping disabled ":" clipping enabled ";this.handler.devMessage(r),this.clipping=!this.clipping,l=!1}if(t.four){var o=this.superSpeed?" super speed disabled ":" super speed enabled ";this.handler.devMessage(o),this.superSpeed=!this.superSpeed,l=!1}}}}]),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,n,r){i(this,e),this.width=parseInt(t/r),this.height=parseInt(n/r),this.size=r,this.grid=[];for(var o=0;o<=this.width;o++){this.grid[o]=[];for(var a=0;a<=this.height;a++)this.grid[o][a]=[]}}return r(e,[{key:"insert",value:function(e,t){for(var n=Math.max(0,parseInt(e.x/this.size)),i=Math.max(0,parseInt(e.y/this.size)),r=Math.min(this.width,parseInt((e.x+e.width)/this.size)),o=Math.min(this.height,parseInt((e.y+e.height)/this.size)),a=i;a<=o;a++)for(var s=n;s<=r;s++)-1===this.grid[s][a].indexOf(t)&&this.grid[s][a].push(t)}},{key:"retrieve",value:function(e,t){for(var n=Math.max(0,parseInt(e.x/this.size)),i=Math.max(0,parseInt(e.y/this.size)),r=Math.min(this.width,parseInt((e.x+e.width)/this.size)),o=Math.min(this.height,parseInt((e.y+e.height)/this.size)),a=[],s=i;s<=o;s++)for(var u=n;u<=r;u++)this.grid[u][s].forEach(function(e){e!==t&&-1===a.indexOf(e)&&a.push(e)});return a}},{key:"remove",value:function(e,t){for(var n=Math.max(0,parseInt(e.x/this.size)),i=Math.max(0,parseInt(e.y/this.size)),r=Math.min(this.width,parseInt((e.x+e.width)/this.size)),o=Math.min(this.height,parseInt((e.y+e.height)/this.size)),a=i;a<=o;a++)for(var s=n;s<=r;s++)for(var u=0;u<this.grid[s][a].length;u++)this.grid[s][a][u]===t&&this.grid[s][a].splice(u,1)}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getSize",value:function(){return this.size}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return g});var r=n(0),o=n(25),a=n(26),s=n(27),u=n(28),h=n(29),l=n(30),c=n(31),f=n(32),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),y=r.a.getAssets("tiles"),d=[];d[0]=new o.a(0),d[1]=new u.a(1),d[2]=new l.a(2),d[3]=new h.a(3),d[4]=new s.a(4),d[5]=new a.a(5),d[7]=new c.a(7),d[8]=new f.a(8);var g=function(){function e(){i(this,e)}return p(e,null,[{key:"getAssets",value:function(){return y}},{key:"getTiles",value:function(){return d}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(0),s=n(1),u=function(e){function t(e){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.a.getAssets("tiles").path,e))}return o(t,e),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(0),s=n(1),u=function(e){function t(e){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.a.getAssets("tiles").pathBlue,e))}return o(t,e),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(0),s=n(1),u=function(e){function t(e){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.a.getAssets("tiles").pathYellow,e))}return o(t,e),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(0),s=n(1),u=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.a.getAssets("tiles").wall,e));return n.isSolid=!0,n}return o(t,e),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(0),s=n(1),u=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.a.getAssets("tiles").wallBlue,e));return n.isSolid=!0,n}return o(t,e),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(0),s=n(1),u=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.a.getAssets("tiles").wallYellow,e));return n.isSolid=!0,n.disappear=!0,n}return o(t,e),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(0),s=n(1),u=function(e){function t(e){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.a.getAssets("tiles").pathGreen,e))}return o(t,e),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(0),s=n(1),u=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.a.getAssets("tiles").wallGreen,e));return n.isSolid=!0,n}return o(t,e),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return a});var r=n(34),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t){i(this,e),this.handler=t,this.init()}return o(e,[{key:"init",value:function(){this.sources=[],this.lightMap=[],this.fillLightMap()}},{key:"fillLightMap",value:function(){for(var e=this.handler.getWorld().getWorldWidth(),t=this.handler.getWorld().getWorldHeight(),n=0;n<t;n++)for(var i=0;i<e;i++)this.lightMap[i]||(this.lightMap[i]=[]),this.lightMap[i][n]=DEFAULT_LIGHT}},{key:"tick",value:function(){this.sources.forEach(function(e){e.tick()})}},{key:"render",value:function(e,t,n,i,r){this.sources.forEach(function(e){e.render(r)}),this.drawLightBlocks(e,t,n,i,r)}},{key:"drawLightBlocks",value:function(e,t,n,i,r){r.fillStyle="black";for(var o=n;o<i;o++)for(var a=e;a<t;a++){var s=this.handler.getWorld().getTile(a,o).type;r.globalAlpha="switch"===s||"exit"===s?CENTER_LIGHT:this.lightMap[a][o],r.fillRect(a*TILE_WIDTH-this.handler.getGameCamera().getxOffset(),o*TILE_HEIGHT-this.handler.getGameCamera().getyOffset(),TILE_WIDTH,TILE_HEIGHT)}r.globalAlpha=1}},{key:"addSource",value:function(e,t){var n=new r.a(this.handler,e*TILE_WIDTH,t*TILE_HEIGHT,TILE_WIDTH,TILE_HEIGHT,this);this.handler.getWorld().getEntityManager().addEntity(n),this.sources.push(n)}},{key:"setLight",value:function(e,t,n){this.lightMap[e][t]=n}},{key:"removeSources",value:function(){this.handler.getWorld().getEntityManager().removeEntitiesByType("light"),this.sources=[]}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return h});var a=n(4),s=n(0),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=function(e){function t(e,n,o,a,u){i(this,t);var h=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,a,u));return h.manager=h.handler.getWorld().getLightManager(),h.posX=Math.floor(n/TILE_WIDTH),h.posY=Math.floor(o/TILE_HEIGHT),h.bounds.x=0,h.bounds.y=0,h.bounds.width=0,h.bounds.height=0,h.flickering=!1,h.lastFlickerCounter=0,h.flickerToggle=0,h.flickerCount=0,h.flickerTimes=0,h.flickerLength=0,h.moveThrough=!0,h.assets=s.a.getAssets("tiles"),h.type="light",h.init(),h}return o(t,e),u(t,[{key:"init",value:function(){this.makeSureOnWall(),this.expandLight()}},{key:"makeSureOnWall",value:function(){var e=this.posX,t=this.posY;if(1!==this.handler.getWorld().getTile(e,t).id)for(var n=t-1;n<t+1;n++)for(var i=e-1;i<e+1;i++)if(1===this.handler.getWorld().getTile(i,n).id)return this.posX=i,void(this.posY=n)}},{key:"expandLight",value:function(){for(var e=-2;e<3;e++)for(var t=-2;t<3;t++)this.manager.lightMap[this.posX+t][this.posY+e]=Math.min(this.manager.lightMap[this.posX+t][this.posY+e],OUTER_LIGHT);for(var n=-1;n<2;n++)for(var i=-1;i<2;i++)this.manager.lightMap[this.posX+i][this.posY+n]=Math.min(this.manager.lightMap[this.posX+i][this.posY+n],INNER_LIGHT);this.manager.lightMap[this.posX][this.posY]=CENTER_LIGHT}},{key:"dimLights",value:function(e){for(var t=-2;t<3;t++)for(var n=-2;n<3;n++)this.manager.lightMap[this.posX+n][this.posY+t]=Math.min(DEFAULT_LIGHT,OUTER_LIGHT+e);for(var i=-1;i<2;i++)for(var r=-1;r<2;r++)this.manager.lightMap[this.posX+r][this.posY+i]=Math.min(DEFAULT_LIGHT,INNER_LIGHT+e);this.manager.lightMap[this.posX][this.posY]=Math.min(DEFAULT_LIGHT,CENTER_LIGHT+e)}},{key:"chanceToFlicker",value:function(){Math.random()<.85||(this.lastFlickerCounter=0,this.flickerLength=Math.floor(5*Math.random())+4,this.flickering=!0)}},{key:"flickerLights",value:function(){0===this.flickerCount&&(0===this.flickerToggle?(this.dimLights(.25),this.flickerToggle=1):(this.expandLight(),this.flickerToggle=0)),this.flickerCount++,this.flickerCount>=this.flickerLength&&(this.flickerCount=0,this.flickerTimes++),this.flickerTimes>=6&&(this.flickerTimes=0,this.flickering=!1)}},{key:"tick",value:function(){this.flickering?this.flickerLights():++this.lastFlickerCounter>240&&this.chanceToFlicker()}},{key:"render",value:function(e){e.myDrawImage(this.assets.lantern,this.x-this.handler.getGameCamera().getxOffset(),this.y-this.handler.getGameCamera().getyOffset(),this.width,this.height)}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return h});var a=n(0),s=n(4),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=function(e){function t(e,n,o,s,u){i(this,t);var h=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,s,u));return h.assets=a.a.getAssets("tiles"),h.type="exit",h.bounds.x=15,h.bounds.y=15,h.bounds.width=h.width-30,h.bounds.height=h.height-30,h}return o(t,e),u(t,[{key:"tick",value:function(){}},{key:"render",value:function(e){e.myDrawImage(this.assets.exit,this.x-this.handler.getGameCamera().getxOffset(),this.y-this.handler.getGameCamera().getyOffset(),this.width,this.height)}}]),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return l});var a=n(0),s=n(4),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=60,l=function(e){function t(e,n,o,s,u){i(this,t);var h=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,s,u));return h.assets=a.a.getAssets("tiles"),h.type="switch",h.bounds.x=5,h.bounds.y=25,h.bounds.width=h.width-18,h.bounds.height=h.height-35,h.currentSwitch=h.assets.switchGreen,h}return o(t,e),u(t,[{key:"tick",value:function(){h++}},{key:"toggleSwitch",value:function(){h<40||(this.currentSwitch===this.assets.switchGreen?(this.currentSwitch=this.assets.switchBlue,this.color="blue"):(this.currentSwitch=this.assets.switchGreen,this.color="green"),this.handler.getWorld().swapGreenAndBlueTiles(this.color),h=0)}},{key:"render",value:function(e){e.myDrawImage(this.currentSwitch,this.x-this.handler.getGameCamera().getxOffset(),this.y-this.handler.getGameCamera().getyOffset(),this.width,this.height)}}]),t}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return g});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=document.getElementById("dialogue"),a=document.getElementById("speaker"),s=5,u=0,h="",l="",c=!1,f=!1,p=!1,y=[],d=[],g=function(){function e(){i(this,e)}return r(e,[{key:"tick",value:function(){s>=0&&y.length&&(y[0].length?this.speakNextLetter():u>=120?this.resetForNextSentence():u++),s<30&&s++}},{key:"resetForNextSentence",value:function(){y.splice(0,1),d.splice(0,1),o.innerHTML="",a.innerHTML="",u=0}},{key:"speakNextLetter",value:function(){a.innerHTML=d[0]+":";var e=y[0][0];"@"===e&&(c=!c),"$"===e&&(p=!p),"&"===e&&(f=!f),h="",l="",c&&(h+='<span style="color:red">',l+="</span>"),p&&(h+='<span style="color:yellow">',l+="</span>"),f&&(h+="<em>",l+="</em>"),"%"===e&&(l+="<br />"),o.innerHTML+=h+e.replace("%","").replace("@","").replace("&","").replace("$","")+l,y[0].splice(0,1),s=0}},{key:"addWords",value:function(e,t){y.push(t.split("")),d.push(e)}},{key:"clear",value:function(){y=[],d=[],o.innerHTML="",a.innerHTML=""}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=(n(0),n(4)),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(e,n,o,a,s,u){i(this,t);var h=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,a,s));return h.type="journal",h.bounds.x=15,h.bounds.y=15,h.bounds.width=h.width-30,h.bounds.height=h.height-30,h.journal=u,h.triggered=!1,h}return o(t,e),s(t,[{key:"tick",value:function(){}},{key:"render",value:function(e){e.fillStyle="yellow",e.fillRect(this.bounds.x+this.x-this.handler.getGameCamera().getxOffset(),this.bounds.y+this.y-this.handler.getGameCamera().getyOffset(),this.bounds.width,this.bounds.height)}},{key:"triggerEntry",value:function(){var e=this;this.triggered||(this.triggered=!0,this.journal.getText().forEach(function(t){e.handler.getWorld().dialogue.addWords(e.journal.name,t)}))}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(2),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.setText(e.myText()),e.name="Journal #001",e}return o(t,e),s(t,[{key:"myText",value:function(){return["Despite his best efforts, I've stayed alive longer than anyone else...","Before he sent me down into this hellhole, I was able to swipe one of his notebooks. He noticed, and broke my leg with a pipe...","Beware of the grotesque beings down here. One touch from them will plague your mind.","The beings are often slow, so make use of the switches and rotating walls to cut them off.","For all who come after me, I hope to provide some small guidance."]}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(2),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.setText(e.myText()),e.name="Journal #002",e}return o(t,e),s(t,[{key:"myText",value:function(){return["This place seems dark and unending. I feel as though I am peering into the abyss at every turn..","I'm not sure how much farther down it goes... I hope I'll see it to the end.","I have to hope, because the only thing left for me is fear and this damned broken tibia.","One odd thing... I have encountered an $old man$ in some of the darkest corners of the maze.","There is something very calming about him. He makes me feel as though I can push on a little longer.","He never speaks, and those... things never bother him. I wonder why?"]}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(2),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.setText(e.myText()),e.name="Journal #003",e}return o(t,e),s(t,[{key:"myText",value:function(){return["It seems like this place gets larger with each floor I descend. Am I in a pyramid?","The gurgling noises come and go, but a foul stench is always present.","I am feeling migraines from time to time, and hearing an eerie voice constantly calling out to me from within. Like it wants to escape.","I think the silence and darkness are getting the better of me. The $bleeding$ won't stop. I am... afraid."]}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(2),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.setText(e.myText()),e.name="Journal #004",e}return o(t,e),s(t,[{key:"myText",value:function(){return["It has been bothering me for a while and I can't get past it. Those creatures, they seem somehow... familiar.","I'm not sure from when or where, but their faces are familiar to me.","Another thing bothering me is that same old man on every floor. How is he traveling between the floors without passing me?","I'll think more on this later... The voice in my head is getting louder and is more frequent.","(&At the bottom of the page you see these words written in what looks to be @blood@.&)","@... ~HeHe. VeRy GooD!~@"]}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(2),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.setText(e.myText()),e.name="Journal #005",e}return o(t,e),s(t,[{key:"myText",value:function(){return["(&This page is covered in sweat and droplets of @blood@&)","I got a better look at the creatures today.","The strange part is that they all look the same. They all have the same face. %@~WiTH THiS GRoSS SMiLe.~@","It gets creepier. I got a good look at their faces this time in the light.","They all look like the $old man$. &EXACTLY& like him...","@~eVeRy.~","~SiNGLe.~","~oNe.~@"]}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(2),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.setText(e.myText()),e.name="JournaL 0o0o06",e}return o(t,e),s(t,[{key:"myText",value:function(){return["To whomever...@~you~@ has made it this far, the $old man$ on this floor has passed away.%@~He iS DeaD you KNoW.~@","I fear no help is available to you.%@~you aRe aLoNe!~@%I barely made it back here on my own.%@~you WeRe NeVeR aLONE~@","I did find an eerie discovery while searching the old man. It seems he bares the same small branding upon his neck as I do.","I cannot see what mine says, but I believe his to be the letter $C$ followed by a $5 digit number$.%@~you KNoW WHaT THiS MeaNS.~@","The headaches rarely stop now.%@~aND SooN NeVeR WiLL.~@"]}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u});var a=n(2),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(){i(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.setText(e.myText()),e.name="HeHe! My eNTRy",e}return o(t,e),s(t,[{key:"myText",value:function(){return["@~WoW. you Too HaVe MaDe iT To THe eND. WHaT a ViLe JoKe aWaiTS.~","~HoW PiTiFuL i MuST HaVe SeeMeD, THiNKiNG i PuLLeD THe WooL oVeR HiS eyeS.~","~aT THe eND oF THiS FlooR, i HAVE SEEN THE ANSWER. SooN you WiLL Too. SHaLL you GueSS WHaT i SaW?~","~you WouLDN'T BeLieVe Me eVeN iF i ToLD you.~","~SCuRRy oN LiTTLe RaT! you SooN Too WiLL LeaRN THe TRuTH.~@"]}}]),t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,n,r){i(this,e),this.xOffset=n,this.yOffset=r,this.handler=t}return r(e,[{key:"centerOnEntity",value:function(e){this.xOffset=e.getX()-this.handler.getWidth()/2+e.getWidth()/2,this.yOffset=e.getY()-this.handler.getHeight()/2+e.getHeight()/2,this.checkBlankSpace()}},{key:"move",value:function(e,t){this.xOffset+=e,this.yOffset+=t,this.checkBlankSpace()}},{key:"getxOffset",value:function(){return parseInt(this.xOffset)}},{key:"getyOffset",value:function(){return parseInt(this.yOffset)}},{key:"setxOffset",value:function(e){this.xOffset=e}},{key:"setyOffset",value:function(e){this.yOffset=e}},{key:"checkBlankSpace",value:function(){this.xOffset<0?this.xOffset=0:this.xOffset>this.handler.getWorld().getWidth()*TILE_WIDTH-this.handler.getWidth()&&(this.xOffset=this.handler.getWorld().getWidth()*TILE_WIDTH-this.handler.getWidth()),this.yOffset<0?this.yOffset=0:this.yOffset>this.handler.getWorld().getHeight()*TILE_HEIGHT-this.handler.getHeight()&&(this.yOffset=this.handler.getWorld().getHeight()*TILE_HEIGHT-this.handler.getHeight())}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this.game=t,this.console=document.getElementById("console"),this.devMessage(" dev cheats initialized \n 2 - clipping \n 3 - invincibility \n 4 - super speed \n 1 - all cheats ")}return r(e,[{key:"devMessage",value:function(e){var t=["background: linear-gradient(#ffffff, #ff00ff)","border: 1px solid #3E0E02","color: black","display: block","line-height: 40px","text-align: center","font-size: 18px","font-weight: bold"].join(";");console.log("%c"+e,t)}},{key:"getWidth",value:function(){return this.game.getWidth()}},{key:"getHeight",value:function(){return this.game.getHeight()}},{key:"getKeyManager",value:function(){return this.game.getKeyManager()}},{key:"getGameCamera",value:function(){return this.game.getGameCamera()}},{key:"getWorld",value:function(){return this.world}},{key:"setWorld",value:function(e){this.world=e}},{key:"getGame",value:function(){return this.game}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return a});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=[],a=function(){function e(){i(this,e)}return r(e,[{key:"tick",value:function(){this.up=o[38],this.down=o[40],this.left=o[37],this.right=o[39],this.one=o[49],this.two=o[50],this.three=o[51],this.four=o[52],this.a=o[65],this.w=o[87],this.s=o[83],this.d=o[68],this.z=o[90],this.q=o[81],this.enter=o[13]}}]),e}();window.onkeydown=function(e){o[e.keyCode]=!0},window.onkeyup=function(e){o[e.keyCode]=!1}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(6),s=n(5),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(e){function t(e){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}o(t,e),u(t,[{key:"render",value:function(e){if(e){var t=this.handler.getWidth(),n=this.handler.getHeight();e.fillStyle="black",e.fillRect(0,0,t,n),e.drawText({fillColor:"white",text:"you are",fontSize:32,x:90,y:n/4}),e.drawText({fillColor:"yellow",text:"A L O N E",fontSize:64,x:80,y:n/2}),e.drawText({fillColor:"white",text:"press enter",fontSize:32,x:210,y:n/1.4})}}},{key:"getInput",value:function(e){if(this.handler.getKeyManager().enter){var t=new a.a(this.handler);this.handler.getGame().getGameState().setState(t)}}}])}(s.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return o});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this.currentState=null,this.handler=t}return r(e,[{key:"getState",value:function(){return this.currentState}},{key:"setState",value:function(e){this.currentState=e}}]),e}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(52),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(){function e(){i(this,e),this.bgMusic={songData:[{i:[3,59,140,0,1,60,128,3,0,29,92,28,95,0,0,3,96,2,1,2,124,135,11,25,130,4,97,2],p:[1],c:[{n:[112,,,,114,,,,117,,,,114,,,,112,,,,114,,,,117,,,,114,,,,141,,,,,,,,,,,,,,,,138],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]}],rowLen:22050,patternLen:32,endPattern:2},this.loaded=!1,this.lastTime=0,this.logged=0}o(e,[{key:"init",value:function(){var e=new r.a;e.init(this.bgMusic);var t=!1;setInterval(function(){if(!t&&(t=e.generate()>=1)){var n=e.createWave(),i=document.createElement("audio");i.src=URL.createObjectURL(new Blob([n],{type:"audio/wav"})),i.play(),i.volume=.3,setInterval(function(){var t=i.currentTime;e.getData(t,300)&&0===this.logged&&this.logged++,i.play(),i.loop=!0,this.lastTime=t},16)}},0)}},{key:"tick",value:function(){}},{key:"render",value:function(){}}])}()},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function(){var e=function(e){return Math.sin(6.283184*e)},t=function(e){return e%1*2-1},n=function(e){return e%1<.5?1:-1},i=function(e){var t=e%1*4;return t<2?t-1:3-t},r=function(e){return.003959503758*Math.pow(2,(e-128)/12)},o=function(e,t,n){var i=a[e.i[0]],o=e.i[1],s=e.i[3],u=a[e.i[4]],h=e.i[5],l=e.i[8],c=e.i[9],f=e.i[10]*e.i[10]*4,p=e.i[11]*e.i[11]*4,y=e.i[12]*e.i[12]*4,d=1/y,g=e.i[13],v=n*Math.pow(2,2-e.i[14]),b=new Int32Array(f+p+y),w=0,m=0,T=void 0,k=void 0,_=void 0,E=void 0,O=void 0,I=void 0,x=void 0;for(T=0,k=0;T<f+p+y;T++,k++)k>=0&&(g=g>>8|(255&g)<<4,k-=v,I=r(t+(15&g)+e.i[2]-128),x=r(t+(15&g)+e.i[6]-128)*(1+8e-4*e.i[7])),_=1,T<f?_=T/f:T>=f+p&&(_-=(T-f-p)*d),E=I,s&&(E*=_*_),w+=E,O=i(w)*o,E=x,l&&(E*=_*_),m+=E,O+=u(m)*h,c&&(O+=(2*Math.random()-1)*c),b[T]=80*O*_|0;return b},a=[e,n,t,i],s=void 0,u=void 0,h=void 0,l=void 0,c=void 0;this.init=function(e){s=e,u=e.endPattern-2,h=0,l=e.rowLen*e.patternLen*(u+1)*2,c=new Int32Array(l)},this.generate=function(){var t=void 0,n=void 0,i=void 0,r=void 0,f=void 0,p=void 0,y=void 0,d=void 0,g=void 0,v=void 0,b=void 0,w=void 0,m=new Int32Array(l),T=s.songData[h],k=s.rowLen,_=s.patternLen,E=0,O=0,I=void 0,x=void 0,H=!1,M=[];for(i=0;i<=u;++i)for(y=T.p[i],r=0;r<_;++r){var j=y?T.c[y-1].f[r]:0;j&&(T.i[j-1]=T.c[y-1].f[r+_]||0,j<16&&(M=[]));var L=a[T.i[15]],P=T.i[16]/512,W=Math.pow(2,T.i[17]-9)/k,S=T.i[18],C=T.i[19],G=43.23529*T.i[20]*3.141592/44100,D=1-T.i[21]/255,R=1e-5*T.i[22],A=T.i[23]/32,z=T.i[24]/512,N=6.283184*Math.pow(2,T.i[25]-9)/k,B=T.i[26]/255,F=T.i[27]*k;for(b=(i*_+r)*k,f=0;f<4;++f)if(p=y?T.c[y-1].n[r+f*_]:0){M[p]||(M[p]=o(T,p,k));var Y=M[p];for(n=0,t=2*b;n<Y.length;n++,t+=2)m[t]+=Y[n]}for(n=0;n<k;n++)d=2*(b+n),v=m[d],v||H?(w=G,S&&(w*=L(W*d)*P+.5),w=1.5*Math.sin(w),E+=w*O,I=D*(v-O)-E,O+=w*I,v=3==C?O:1==C?I:E,R&&(v*=R,v=v<1?v>-1?e(.25*v):-1:1,v/=R),v*=A,H=v*v>1e-5,g=Math.sin(N*d)*z+.5,x=v*(1-g),v*=g):x=0,d>=F&&(x+=m[d-F+1]*B,v+=m[d-F]*B),m[d]=0|x,m[d+1]=0|v,c[d]+=0|x,c[d+1]+=0|v}return++h/8},this.createWave=function(){var e=44+2*l-8,t=e-36,n=new Uint8Array(44+2*l);n.set([82,73,70,70,255&e,e>>8&255,e>>16&255,e>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&t,t>>8&255,t>>16&255,t>>24&255]);for(var i=0,r=44;i<l;++i){var o=c[i];o=o<-32767?-32767:o>32767?32767:o,n[r++]=255&o,n[r++]=o>>8&255}return n},this.getData=function(e,t){for(var n=2*Math.floor(44100*e),i=new Array(t),r=0;r<2*t;r+=1){var o=n+r;i[r]=e>0&&o<c.length?c[o]/32768:0}return i}}},function(e,t){}]);</script></body>

</html>

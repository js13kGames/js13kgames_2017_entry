<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">body,html{background-color:#000;height:100%;margin:0;padding:0;width:100%}#canvas{background-color:inherit;border-radius:235px;margin:50px 0 0 -224px}#canvas,.speech{left:50%;position:fixed;z-index:100}.speech{font-family:Arial,"serif";line-height:36px;font-size:24px;padding:0;top:408px}#dialogue{color:#fff;height:324px;margin:112px 0 0 -190px;width:600px}#speaker{color:#ff0;height:50px;margin:112px 0 0 -425px;text-align:right;width:200px}</style></head>

<body>
    <canvas id="canvas"></canvas>

    <div id="dialogue" class="speech"></div>

    <div id="speaker" class="speech"></div>
<script type="text/javascript">!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=10)}([function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return l});var r=n(17),o=n(18),a=n(19),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u={},h=window.location.href.replace("index.html","")+"src/res/",l=function(){function t(e,n,r,s){i(this,t),u[e]=this,this.name=e,this.path=n,this.width=r,this.height=s,this.sheet=new a.a(o.a.loadImage(this.path)),this.animations={}}return s(t,[{key:"addAnimation",value:function(t,e){this.animations[t]=e}},{key:"getWidth",value:function(){return 16}},{key:"getHeight",value:function(){return 16}}],[{key:"getAssets",value:function(t){return u[t]}}]),t}(),c=function(t,e,n){return t.sheet.crop(16*e,16*n,16,16)},f=new l("tiles",h+"all_tiles.png",16,16);f.path=c(f,1,0),f.pathYellow=c(f,1,1),f.wall=c(f,0,0),f.wallYellow=c(f,0,1),f.exit=c(f,1,2),f.lantern=c(f,0,2);var p=function(t,e,n,i,o,a){for(var s=[],u=[],h=[],l=[],c=0;c<2;c++)h.push({frame:t.sheet.crop(t.width*c,t.height*n,t.width,t.height),speed:200}),s.push({frame:t.sheet.crop(t.width*c,t.height*i+1,t.width,t.height),speed:200}),l.push({frame:t.sheet.crop(t.width*c,t.height*o+1,t.width,t.height),speed:200}),u.push({frame:t.sheet.crop(t.width*c,t.height*a+1,t.width,t.height),speed:200});t.addAnimation(e+"walk_up",new r.a(h)),t.addAnimation(e+"walk_right",new r.a(s)),t.addAnimation(e+"walk_down",new r.a(l)),t.addAnimation(e+"walk_left",new r.a(u))};p(f,"p",3,4,5,6),p(f,"c",7,8,9,10)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e,n,r,o){i(this,t),this.x=e,this.y=n,this.width=r,this.height=o}return r(t,[{key:"intersects",value:function(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var r=n(0),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(e,n){i(this,t),this.isSolid=!1,this.texture=e,this.id=n,this.assets=r.a.getAssets("tiles")}return o(t,[{key:"render",value:function(t,e,n){t.myDrawImage(this.texture,e,n,TILE_WIDTH,TILE_HEIGHT)}},{key:"getId",value:function(){return this.id}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(){i(this,t)}return r(t,[{key:"getText",value:function(){return this.text}},{key:"setText",value:function(t){this.text=t}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e){i(this,t),this.handler=e,this.countSinceInput=0}return r(t,[{key:"tick",value:function(){this.countSinceInput++,this.countSinceInput>8&&this.getInput(),this.render()}},{key:"draw",value:function(t,e){t&&(t.fillStyle="black",t.fillRect(0,0,600,600),t.drawText({fillColor:"red",text:e[0],fontSize:32,x:150,y:150}),t.drawText({fillColor:"yellow",text:e[1],fontSize:22,x:200,y:225}),t.drawText({fillColor:"yellow",text:e[2],fontSize:18,x:125,y:275}),t.drawText({fillColor:"white",text:e[3],fontSize:32,x:150,y:350}))}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return s});var a=n(8),s=function(t){function e(t,n,o,a,s){return i(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a,s))}return o(e,t),e}(a.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var r=n(14),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(e){i(this,t),this.handler=e,this.world=new r.a(e)}return o(t,[{key:"tick",value:function(t){this.world.tick(t)}},{key:"render",value:function(t){this.world.render(t)}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return l});var a=n(8),s=n(1),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=void 0,l=function(t){function e(t,n,o){i(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,64,64));return a.speed=80,a.xMove=0,a.yMove=0,a}return o(e,t),u(e,[{key:"tick",value:function(){h="player"===this.type?"p":"c",this.yMove<0&&this.assets.animations[h+"walk_up"].tick(),this.yMove>0&&this.assets.animations[h+"walk_down"].tick(),this.xMove>0&&this.assets.animations[h+"walk_right"].tick(),this.xMove<0&&this.assets.animations[h+"walk_left"].tick()}},{key:"move",value:function(){(Math.abs(this.xMove)>0||Math.abs(this.yMove)>0)&&(this.handler.getWorld().getSpatialGrid().remove(new s.a(this.x+this.bounds.x,this.y+this.bounds.y,this.bounds.width,this.bounds.height),this),this.checkEntityCollisions(this.xMove,0)||this.moveX(),this.checkEntityCollisions(0,this.yMove)||this.moveY(),this.handler.getWorld().getSpatialGrid().insert(new s.a(this.x+this.bounds.x,this.y+this.bounds.y,this.bounds.width,this.bounds.height),this))}},{key:"moveX",value:function(){if(this.clipping)return void(this.x+=this.xMove);var t=this.xMove>0?parseInt((this.x+this.xMove+this.bounds.x+this.bounds.width)/TILE_WIDTH):parseInt((this.x+this.xMove+this.bounds.x)/TILE_WIDTH),e=parseInt((this.y+this.bounds.y)/TILE_HEIGHT),n=parseInt((this.y+this.bounds.y+this.bounds.height)/TILE_HEIGHT),i=this.xMove>0?t*TILE_WIDTH-this.bounds.x-this.bounds.width-1:t*TILE_WIDTH+TILE_WIDTH-this.bounds.x;this.collisionWithTile(t,e)||this.collisionWithTile(t,n)?this.x=i:this.x+=this.xMove}},{key:"moveY",value:function(){if(this.clipping)return void(this.y+=this.yMove);var t=this.yMove>0?parseInt((this.y+this.yMove+this.bounds.y+this.bounds.height)/TILE_HEIGHT):parseInt((this.y+this.yMove+this.bounds.y)/TILE_HEIGHT),e=parseInt((this.x+this.bounds.x)/TILE_WIDTH),n=parseInt((this.x+this.bounds.x+this.bounds.width)/TILE_WIDTH),i=this.yMove>0?t*TILE_HEIGHT-this.bounds.y-this.bounds.height-1:t*TILE_HEIGHT+TILE_HEIGHT-this.bounds.y;this.collisionWithTile(e,t)||this.collisionWithTile(n,t)?this.y=i:this.y+=this.yMove}},{key:"collisionWithTile",value:function(t,e){try{return this.handler.getWorld().getTile(t,e).isSolid}catch(t){}}},{key:"getCurrentAnimationFrame",value:function(){return h="player"===this.type?"p":"c",this.xMove<0?(this.lastAnimation=h+"walk_left",this.assets.animations[h+"walk_left"].getCurrentFrame()):this.xMove>0?(this.lastAnimation=h+"walk_right",this.assets.animations[h+"walk_right"].getCurrentFrame()):this.yMove<0?(this.lastAnimation=h+"walk_up",this.assets.animations[h+"walk_up"].getCurrentFrame()):this.yMove>0?(this.lastAnimation=h+"walk_down",this.assets.animations[h+"walk_down"].getCurrentFrame()):this.assets.animations[this.lastAnimation].getCurrentFrame()}}]),e}(a.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return u});var r=n(20),o=n(9),a=n(1),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function(){function t(e,n,r,o,s){i(this,t),this.x=n,this.y=r,this.width=o,this.height=s,this.handler=e,this.bounds=new a.a(0,0,o,s),this.moveThrough=!1}return s(t,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getCollisionBounds",value:function(t,e){return new a.a(parseInt(this.x+this.bounds.x+t),parseInt(this.y+this.bounds.y+e),this.bounds.width,this.bounds.height)}},{key:"checkEntityCollisions",value:function(t,e){for(var n=this.handler.getWorld().getSpatialGrid().retrieve(new a.a(this.x+this.bounds.x+t,this.y+this.bounds.y+e,this.bounds.width,this.bounds.height),this),i=0;i<n.length;i++){var r=n[i];if(r.moveThrough)return!1;if(r.getCollisionBounds(0,0).intersects(this.getCollisionBounds(t,e)))return this.checkForCollisionEvents(this,r),!0}return!1}},{key:"checkForCollisionEvents",value:function(t,e){if(!this.checkCollidingTypes(t,e,"monster","monster")){var n=this.handler,i=n.getGame(),a=n.getWorld(),s=a.entityManager;if(this.checkCollidingTypes(t,e,"player","journal")&&("journal"===t.type?(t.triggerEntry(),s.removeEntity(t)):(e.triggerEntry(),s.removeEntity(e))),this.checkCollidingTypes(t,e,"player","exit")){if(a.level>=4){a.dialogue.clear();var u=new r.a(this.handler);i.getGameState().setState(u)}return void a.changeLevel()}if(this.checkCollidingTypes(t,e,"player","monster")){if(t.invincible||e.invincible)return;a.dialogue.clear();var h=new o.a(t.handler,['"Looks like this one',"couldn't dodge his brothers...\""]);i.getGameState().setState(h)}}}},{key:"checkCollidingTypes",value:function(t,e,n,i){return t.type===n&&e.type===i||t.type===i&&e.type===n}},{key:"setX",value:function(t){this.x=t}},{key:"setY",value:function(t){this.y=t}},{key:"setWidth",value:function(t){this.width=t}},{key:"setHeight",value:function(t){this.height=t}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return h});var a=n(4),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},h=function(t){function e(t,n){i(this,e);var o=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.reason=n,o}return o(e,t),s(e,[{key:"render",value:function(t){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t,["Y O U   D I E D",this.reason[0],this.reason[1],"press enter..."])}},{key:"getInput",value:function(){this.handler.getKeyManager().enter&&window.location.reload()}}]),e}(a.a)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(n(11),n(45));n.n(i)},function(t,e,n){"use strict";var i=n(12);window.TILE_HEIGHT=64,window.TILE_WIDTH=64,window.DEFAULT_LIGHT=.85,window.CENTER_LIGHT=.3,window.INNER_LIGHT=.5,window.OUTER_LIGHT=.65,new i.a("Lost!",448,448).start()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return k});var r=n(13),o=n(6),a=n(38),s=n(39),u=n(40),h=(n(41),n(42)),l=n(43),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),f=!1,p=void 0,y=void 0,d=void 0,g=void 0,v=void 0,b=void 0,w=void 0,m=void 0,k=function(){function t(e,n,r){i(this,t),this.height=r,this.title=e,this.width=n}return c(t,[{key:"run",value:function(){var t=this;this.init();var e=0,n=0,i=Date.now(),r=Date.now(),o=0;!function a(){f&&(i=Date.now(),e=i-r,o+=e,r=i),o>=1e3/60&&(n=o/1e3,t.tick(n),t.render(),o=0),window.requestAnimationFrame(a)}()}},{key:"start",value:function(){f||(f=!0,this.run())}},{key:"getKeyManager",value:function(){return d}},{key:"getDisplay",value:function(){return y}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getGameCamera",value:function(){return v}},{key:"getGameState",value:function(){return w}},{key:"init",value:function(){g=new s.a(this),y=new r.a(this.title,this.width,this.height),d=new u.a,p=y.getGraphics(),w=new h.a,v=new a.a(g,0,0),b=new l.a,g.setSM(b),m=new o.a(g),w.setState(m)}},{key:"tick",value:function(t){d.tick(),w.getState()&&!y.paused&&w.getState().tick(t)}},{key:"render",value:function(){w.getState()&&!y.paused&&w.getState().render(p)}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=null,a=function(){function t(e,n,r){i(this,t),this.title=e,this.width=n,this.height=r,this.paused=!1,this.createDisplay()}return r(t,[{key:"createDisplay",value:function(){document.title=this.title;var t=document.getElementById("canvas");t.setAttribute("height",this.height),t.setAttribute("width",this.width),o=t.getContext("2d"),o.webkitImageSmoothingEnabled=!1,o.mozImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1,this.setEventListeners()}},{key:"setEventListeners",value:function(){window.onblur=this.pause,window.onfocus=this.unPause}},{key:"pause",value:function(){this.paused=!0}},{key:"unPause",value:function(){this.paused=!1}},{key:"getTitle",value:function(){return this.title}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getGraphics",value:function(){return o}}]),t}();CanvasRenderingContext2D.prototype.myDrawImage=function(t,e,n,i,r){o.drawImage(t.sheet,t.x,t.y,t.width,t.height,e,n,i,r)},CanvasRenderingContext2D.prototype.drawText=function(t){o.font=t.fontSize+"px Arial",o.fillStyle=t.fillColor,o.strokeText(t.text,t.x,t.y),o.fillText(t.text,t.x,t.y)}},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return x});var r=n(15),o=n(16),a=n(21),s=n(22),u=n(23),h=n(24),l=n(29),c=n(31),f=n(32),p=n(9),y=n(33),d=n(34),g=n(35),v=n(36),b=n(37),w=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),m=!1,k=!1,T=0,_=0,O=20,E=0,I=0,x=function(){function t(e){i(this,t),this.width=null,this.height=null,this.tiles=[],this.handler=e,e.setWorld(this),this.entityManager=new r.a(e,new s.a(e,20,20)),this.spatialGrid=new u.a(this.handler.getWidth()*TILE_WIDTH,this.handler.getHeight()*TILE_HEIGHT,64),this.level=1,this.loadWorld(),this.lightManager=new l.a(e),this.dialogue=new f.a,this.init()}return w(t,[{key:"getLightManager",value:function(){return this.lightManager}},{key:"changeLevel",value:function(){this.setPlayerSpawn(this.spawnX,this.spawnY),this.level+=1,this.tiles=[],_=0,this.lightManager.removeSources(),this.entityManager.removeEntitiesByType("exit"),this.entityManager.removeEntitiesByType("journal"),k||this.entityManager.removeEntitiesByType("monster"),k=!1,this.loadWorld(),this.init()}},{key:"init",value:function(){this.setPlayerSpawn(this.spawnX,this.spawnY),this.lightManager.init(),this.lightManager.fillLightMap(),1===this.level&&(this.entityManager.addEntity(new o.a(this.handler,6*TILE_WIDTH,2*TILE_WIDTH)),this.lightManager.addSource(4,5)),this.entityManager.addEntity(new c.a(this.handler,(this.width-2)*TILE_WIDTH,(this.height-2)*TILE_HEIGHT,TILE_WIDTH,TILE_HEIGHT)),this.addEvenSpreadOfLightSources(7),1!==this.level&&this.addEvenSpreadOfMonsters(6),this.spawnJournals()}},{key:"spawnJournals",value:function(){var t=[new d.a,new g.a,new v.a,new b.a];this.entityManager.addEntity(new y.a(this.handler,2*TILE_WIDTH,2*TILE_HEIGHT,TILE_WIDTH,TILE_HEIGHT,t[this.level-1]))}},{key:"addEvenSpreadOfLightSources",value:function(t){for(var e=t;e<=this.height;e+=t)for(var n=t;n<=this.width;n+=t)this.height-e>2&&this.width-n>2&&this.lightManager.addSource(n,e)}},{key:"getWorldHeight",value:function(){return this.height}},{key:"getWorldWidth",value:function(){return this.width}},{key:"addEvenSpreadOfMonsters",value:function(t){for(var e=t;e<=this.height;e+=t)for(var n=t;n<=this.width;n+=t)this.height-e>2&&this.width-n>2&&this.entityManager.addEntity(new o.a(this.handler,n*TILE_WIDTH,e*TILE_WIDTH))}},{key:"setPlayerSpawn",value:function(t,e){this.entityManager.getPlayer().setX(t),this.entityManager.getPlayer().setY(e)}},{key:"loadWorld",value:function(){for(var t=this.fillWorld(),e=0;e<this.height;e++)for(var n=0;n<this.width;n++)this.tiles[n]||(this.tiles[n]=[]),this.tiles[n][e]=t[n][e]}},{key:"fillWorld",value:function(){var t=a.a.getRandomMaze(this.level,1,1);return this.height=t.mazeHeight,this.width=t.mazeWidth,this.spawnX=t.spawnX*TILE_WIDTH,this.spawnY=t.spawnY*TILE_HEIGHT,t.pieces}},{key:"swapWalls",value:function(t,e){for(var n=1;n<this.height;n++)for(var i=1;i<this.width;i++)this.tiles[i][n]===t&&(this.tiles[i][n]=e)}},{key:"checkForWallSwap",value:function(){++T>300&&(this.handler.getSM().play("wall"),T=0,m?this.swapWalls(4,2):this.swapWalls(2,4),m=!m)}},{key:"plusTime",value:function(){if(I++,60===I&&(E=0===E?59:E-=1,59===E&&O--,I=0),E<=0&&O<=0){var t=new p.a(this.handler,['"Time\'s up!"','"This one didn\'t make it either..."']);this.handler.getGame().getGameState().setState(t)}}},{key:"tick",value:function(t){this.checkForWallSwap(),this.entityManager.tick(t),this.lightManager.tick(t),this.dialogue.tick(),this.plusTime(),k||1===this.level||++_/60>=300&&(alert("the monsters crumble all around you."),this.entityManager.removeEntitiesByType("monster"),k=!0)}},{key:"render",value:function(t){for(var e=parseInt(Math.max(0,this.handler.getGameCamera().getxOffset()/TILE_WIDTH)),n=parseInt(Math.min(this.width,(this.handler.getGameCamera().getxOffset()+this.handler.getWidth())/TILE_WIDTH+1)),i=parseInt(Math.max(0,this.handler.getGameCamera().getyOffset()/TILE_HEIGHT)),r=parseInt(Math.min(this.height,(this.handler.getGameCamera().getyOffset()+this.handler.getHeight())/TILE_HEIGHT+1)),o=i;o<r;o++)for(var a=e;a<n;a++)void 0!==this.getTile(a,o)&&this.getTile(a,o).render(t,a*TILE_WIDTH-this.handler.getGameCamera().getxOffset(),o*TILE_HEIGHT-this.handler.getGameCamera().getyOffset());this.entityManager.render(t),this.lightManager.render(e,n,i,r,t),t.drawText({fillColor:"white",text:(1===O.toString().length?"0"+O:O)+":"+(1===E.toString().length?"0"+E:E),fontSize:40,x:174,y:50})}},{key:"getTile",value:function(t,e){try{return h.a.getTiles()[this.tiles[t][e]]}catch(t){}}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getEntityManager",value:function(){return this.entityManager}},{key:"getSpatialGrid",value:function(){return this.spatialGrid}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return l});var r=n(1),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=void 0,s=void 0,u=void 0,h=function(t,e){var n=t.getY(),i=e.getY(),r=t.getHeight(),o=e.getHeight();return n+r===i+o?0:n+r<i+o?-1:1},l=function(){function t(e,n){i(this,t),a=e,s=n,u=new Array(s)}return o(t,[{key:"tick",value:function(t){u.sort(h);for(var e=0;e<u.length;e++){u[e].tick(t)}}},{key:"render",value:function(t){u.forEach(function(e){e.handler.getWidth()+e.handler.getGameCamera().getxOffset()&&e.handler.getHeight()+e.handler.getGameCamera().getyOffset()&&e.handler.getGameCamera().getxOffset()-e.width&&e.handler.getGameCamera().getyOffset()-e.height&&e.render(t)})}},{key:"getPlayer",value:function(){return s}},{key:"getHandler",value:function(){return a}},{key:"getEntities",value:function(){return u}},{key:"addEntity",value:function(t){u.push(t),a.getWorld().getSpatialGrid().insert(new r.a(t.x+t.bounds.x,t.y+t.bounds.y,t.bounds.width,t.bounds.height),t)}},{key:"removeEntity",value:function(t){var e=u.indexOf(t);a.getWorld().getSpatialGrid().remove(new r.a(t.x+t.bounds.x,t.y+t.bounds.y,t.bounds.width,t.bounds.height),t),u.splice(e,1)}},{key:"removeEntitiesByType",value:function(t){u=u.filter(function(e){if(e.type!==t)return e;a.getWorld().getSpatialGrid().remove(new r.a(e.x+e.bounds.x,e.y+e.bounds.y,e.bounds.width,e.bounds.height),e)})}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return l});var a=n(0),s=n(7),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=function(t){function e(t,n,o){i(this,e);var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,TILE_WIDTH,TILE_HEIGHT));return s.assets=a.a.getAssets("tiles"),s.x=n,s.y=o,s.spawnX=n,s.spawnY=o,s.bounds.x=10,s.bounds.y=10,s.bounds.width=TILE_WIDTH-2*s.bounds.x,s.bounds.height=TILE_HEIGHT-2*s.bounds.y,s.type="monster",s.patrol=s.getPatrolPattern(),s.patrolLength=100,s.dirMoving=0,s.numberOfMoves=0,s.lastAnimation="cwalk_down",s}return o(e,t),u(e,[{key:"getPatrolPattern",value:function(){var t=["vertical","horizontal"];return t[Math.floor(Math.random()*t.length)]}},{key:"maybeChangePatrol",value:function(){Math.random()<.3&&(this.patrol="vertical"===this.patrol?"horizontal":"vertical")}},{key:"checkIfOffMap",value:function(){var t=this.handler.getWorld().getWorldWidth()*TILE_WIDTH,e=this.handler.getWorld().getWorldHeight()*TILE_HEIGHT;(this.x<1||this.y<1||this.x>t||this.y>e)&&(this.x=this.spawnX,this.y=this.spawnY)}},{key:"setPatrolMovement",value:function(t){"vertical"===this.patrol?(0===this.dirMoving?this.yMove=-this.speed*t:this.yMove=this.speed*t,++this.numberOfMoves>this.patrolLength&&(this.dirMoving=0===this.dirMoving?1:0,this.numberOfMoves=0,this.maybeChangePatrol())):"horizontal"===this.patrol&&(0===this.dirMoving?this.xMove=-this.speed*t:this.xMove=this.speed*t,++this.numberOfMoves>this.patrolLength&&(this.dirMoving=0===this.dirMoving?1:0,this.numberOfMoves=0,this.maybeChangePatrol()))}},{key:"checkIfInWall",value:function(){var t=Math.round(this.x/TILE_WIDTH),e=Math.round(this.y/TILE_HEIGHT);if(this.handler.getWorld().getTile(t,e).isSolid)for(var n=t-1,i=e-1,r=t+1,o=e+1,a=i;a<o;a++)for(var s=n;s<r;s++)if(!this.handler.getWorld().getTile(s,a).isSolid&&(s===t||a===e))return this.x=s*TILE_WIDTH,void(this.y=a*TILE_HEIGHT)}},{key:"tick",value:function(t){this.checkIfOffMap(),this.checkIfInWall(),this.setPatrolMovement(t),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"tick",this).call(this),this.move()}},{key:"render",value:function(t){t.myDrawImage(this.getCurrentAnimationFrame(),this.x-this.handler.getGameCamera().getxOffset(),this.y-this.handler.getGameCamera().getyOffset(),this.width,this.height)}}]),e}(s.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e){i(this,t),this.frames=e,this.index=0,this.lastTime=Date.now(),this.timer=0,this.speed=1e3}return r(t,[{key:"tick",value:function(){this.timer+=Date.now()-this.lastTime,this.lastTime=Date.now(),this.timer>=this.speed&&(this.index++,this.timer=0,this.index>=this.frames.length&&(this.index=0))}},{key:"getCurrentFrame",value:function(){return this.speed=this.frames[this.index].speed,this.frames[this.index].frame}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(){i(this,t)}return r(t,null,[{key:"loadImage",value:function(t){var e=new Image;return e.src=t,e}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e){i(this,t),this.sheet=e}return r(t,[{key:"crop",value:function(t,e,n,i){return{sheet:this.sheet,x:t,y:e,width:n,height:i}}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return h});var a=n(4),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},h=function(t){function e(t){return i(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),s(e,[{key:"render",value:function(t){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t,["You escaped","Our best one yet..","Welcome brother, we are family...","the end..."])}},{key:"getInput",value:function(){this.handler.getKeyManager().enter&&window.location.reload()}}]),e}(a.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return l});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=[],a=[],s=0,u=0,h=function(t,e){return 0===t||0===e||t===s-1||e===u-1?1:Math.floor(20*Math.random())<10?1:2},l=function(){function t(){i(this,t)}return r(t,null,[{key:"createMaze",value:function(){for(var t=[],e=0;e<u;e++){o[e]=[];for(var n=0;n<s;n++)o[e][n]=1}var i=1,r=1;o[i][r]=0,t.push(r+r*s);do{if(t.length){var a="";if(i+2>0&&i+2<u-1&&1==o[i+2][r]&&(a+="S"),i-2>0&&i-2<u-1&&1==o[i-2][r]&&(a+="N"),r-2>0&&r-2<s-1&&1==o[i][r-2]&&(a+="W"),r+2>0&&r+2<s-1&&1==o[i][r+2]&&(a+="E"),a){var h=Math.floor(Math.random()*a.length);switch(a[h]){case"N":o[i-2][r]=0,o[i-1][r]=0,i-=2;break;case"S":o[i+2][r]=0,o[i+1][r]=0,i+=2;break;case"W":o[i][r-2]=0,o[i][r-1]=0,r-=2;break;case"E":o[i][r+2]=0,o[i][r+1]=0,r+=2}t.push(r+i*s)}else{var l=t.pop();i=Math.floor(l/s),r=l%s}this.buildFinalMaze(i,r)}}while(t.length)}},{key:"buildFinalMaze",value:function(){for(var t=0;t<u;t++)for(var e=0;e<s;e++)a[e]||(a[e]=[]),a[e][t]=1===o[t][e]?h(t,e):0}},{key:"createRooms",value:function(){this.createRoom(1,1,3),this.createRoom(1,u-4,3),this.createRoom(s-4,u-4,3),this.createRoom(s-4,1,3)}},{key:"createRoom",value:function(t,e,n){for(var i=e;i<e+n;i++)for(var r=t;r<t+n;r++)a[r][i]=0}},{key:"createBarriers",value:function(t){2!==t&&(a[1][Math.ceil(u/2)]=1,a[1][Math.ceil(u/2)+1]=1,a[s-2][Math.ceil(u/2)]=1,a[s-2][Math.ceil(u/2)+1]=1,a[Math.ceil(s/2)][1]=1,a[Math.ceil(s/2)+1][1]=1,a[Math.ceil(s/2)][u-2]=1,a[Math.ceil(s/2)+1][u-2]=1)}},{key:"getIntroMaze",value:function(){return[[1,1,1,1,1,1,1,1,1],[1,0,0,2,0,0,0,0,1],[1,0,0,2,0,0,2,0,1],[1,2,2,2,0,2,2,0,1],[1,0,0,0,0,0,2,0,1],[1,2,2,2,0,2,2,0,1],[1,0,0,2,0,0,2,0,1],[1,0,0,2,0,0,0,0,1],[1,1,1,1,1,1,1,1,1]]}},{key:"getRandomMaze",value:function(t,e,n){return 1===t?{mazeWidth:9,mazeHeight:9,spawnX:1,spawnY:1,pieces:this.getIntroMaze()}:(s=u=10*t-1,this.createMaze(),this.createRooms(),this.createBarriers(t),{mazeWidth:s,mazeHeight:u,spawnX:e,spawnY:n,pieces:a})}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return l});var a=n(0),s=n(7),u=(n(1),function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()),h=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=function(t){function e(t,n,o){i(this,e);var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o));return s.assets=a.a.getAssets("tiles"),s.x=n,s.y=o,s.speed=140,s.bounds.x=14,s.bounds.y=24,s.bounds.width=36,s.bounds.height=39,s.type="player",s.clipping=!1,s.invincible=!1,s.superSpeed=!1,s.allCheats=!1,s.lastAnimation="pwalk_down",s}return o(e,t),u(e,[{key:"tick",value:function(t){this.xMove=this.yMove=0,this.getInput(t),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"tick",this).call(this,t),this.move(),this.superSpeed&&(this.move(),this.move()),this.handler.getGameCamera().centerOnEntity(this)}},{key:"render",value:function(t){t.myDrawImage(this.getCurrentAnimationFrame(),this.x-this.handler.getGameCamera().getxOffset(),this.y-this.handler.getGameCamera().getyOffset(),TILE_WIDTH,TILE_HEIGHT)}},{key:"getInput",value:function(t){var e=this.handler.getKeyManager();(e.up||e.w||e.z)&&(this.yMove=-this.speed*t),(e.down||e.s)&&(this.yMove=this.speed*t),(e.left||e.a||e.q)&&(this.xMove=-this.speed*t),(e.right||e.d)&&(this.xMove=this.speed*t)}}]),e}(s.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e,n,r){i(this,t),this.width=parseInt(e/r),this.height=parseInt(n/r),this.size=r,this.grid=[];for(var o=0;o<=this.width;o++){this.grid[o]=[];for(var a=0;a<=this.height;a++)this.grid[o][a]=[]}}return r(t,[{key:"insert",value:function(t,e){for(var n=Math.max(0,parseInt(t.x/this.size)),i=Math.max(0,parseInt(t.y/this.size)),r=Math.min(this.width,parseInt((t.x+t.width)/this.size)),o=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=i;a<=o;a++)for(var s=n;s<=r;s++)-1===this.grid[s][a].indexOf(e)&&this.grid[s][a].push(e)}},{key:"retrieve",value:function(t,e){for(var n=Math.max(0,parseInt(t.x/this.size)),i=Math.max(0,parseInt(t.y/this.size)),r=Math.min(this.width,parseInt((t.x+t.width)/this.size)),o=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=[],s=i;s<=o;s++)for(var u=n;u<=r;u++)this.grid[u][s].forEach(function(t){t!==e&&-1===a.indexOf(t)&&a.push(t)});return a}},{key:"remove",value:function(t,e){for(var n=Math.max(0,parseInt(t.x/this.size)),i=Math.max(0,parseInt(t.y/this.size)),r=Math.min(this.width,parseInt((t.x+t.width)/this.size)),o=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=i;a<=o;a++)for(var s=n;s<=r;s++)for(var u=0;u<this.grid[s][a].length;u++)this.grid[s][a][u]===e&&this.grid[s][a].splice(u,1)}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getSize",value:function(){return this.size}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return f});var r=n(0),o=n(25),a=n(26),s=n(27),u=n(28),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=r.a.getAssets("tiles"),c=[];c[0]=new o.a(0),c[1]=new s.a(1),c[2]=new u.a(2),c[4]=new a.a(4);var f=function(){function t(){i(this,t)}return h(t,null,[{key:"getAssets",value:function(){return l}},{key:"getTiles",value:function(){return c}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return u});var a=n(0),s=n(2),u=function(t){function e(t){return i(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a.a.getAssets("tiles").path,t))}return o(e,t),e}(s.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return u});var a=n(0),s=n(2),u=function(t){function e(t){return i(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a.a.getAssets("tiles").pathYellow,t))}return o(e,t),e}(s.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return u});var a=n(0),s=n(2),u=function(t){function e(t){i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a.a.getAssets("tiles").wall,t));return n.isSolid=!0,n}return o(e,t),e}(s.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return u});var a=n(0),s=n(2),u=function(t){function e(t){i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a.a.getAssets("tiles").wallYellow,t));return n.isSolid=!0,n}return o(e,t),e}(s.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var r=n(30),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(e){i(this,t),this.handler=e,this.init()}return o(t,[{key:"init",value:function(){this.sources=[],this.lightMap=[],this.fillLightMap()}},{key:"fillLightMap",value:function(){for(var t=this.handler.getWorld().getWorldWidth(),e=this.handler.getWorld().getWorldHeight(),n=0;n<e;n++)for(var i=0;i<t;i++)this.lightMap[i]||(this.lightMap[i]=[]),this.lightMap[i][n]=DEFAULT_LIGHT}},{key:"tick",value:function(){this.sources.forEach(function(t){t.tick()})}},{key:"render",value:function(t,e,n,i,r){this.sources.forEach(function(t){t.render(r)}),this.drawLightBlocks(t,e,n,i,r)}},{key:"drawLightBlocks",value:function(t,e,n,i,r){r.fillStyle="black";for(var o=n;o<i;o++)for(var a=t;a<e;a++)r.globalAlpha=this.lightMap[a][o],r.fillRect(a*TILE_WIDTH-this.handler.getGameCamera().getxOffset(),o*TILE_HEIGHT-this.handler.getGameCamera().getyOffset(),TILE_WIDTH,TILE_HEIGHT);r.globalAlpha=1}},{key:"addSource",value:function(t,e){var n=new r.a(this.handler,t*TILE_WIDTH,e*TILE_HEIGHT,TILE_WIDTH,TILE_HEIGHT,this);this.handler.getWorld().getEntityManager().addEntity(n),this.sources.push(n)}},{key:"setLight",value:function(t,e,n){this.lightMap[t][e]=n}},{key:"removeSources",value:function(){this.handler.getWorld().getEntityManager().removeEntitiesByType("light"),this.sources=[]}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return h});var a=n(5),s=n(0),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=function(t){function e(t,n,o,a,u){i(this,e);var h=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a,u));return h.manager=h.handler.getWorld().getLightManager(),h.posX=Math.floor(n/TILE_WIDTH),h.posY=Math.floor(o/TILE_HEIGHT),h.bounds.x=0,h.bounds.y=0,h.bounds.width=0,h.bounds.height=0,h.flickering=!1,h.lastFlickerCounter=0,h.flickerToggle=0,h.flickerCount=0,h.flickerTimes=0,h.flickerLength=0,h.moveThrough=!0,h.assets=s.a.getAssets("tiles"),h.type="light",h.init(),h}return o(e,t),u(e,[{key:"init",value:function(){this.makeSureOnWall(),this.expandLight()}},{key:"makeSureOnWall",value:function(){var t=this.posX,e=this.posY;if(1!==this.handler.getWorld().getTile(t,e).id)for(var n=e-1;n<e+1;n++)for(var i=t-1;i<t+1;i++)if(1===this.handler.getWorld().getTile(i,n).id)return this.posX=i,void(this.posY=n)}},{key:"expandLight",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=-2;e<3;e++)for(var n=-2;n<3;n++)this.manager.lightMap[this.posX+n][this.posY+e]=t>0?Math.min(DEFAULT_LIGHT,OUTER_LIGHT+t):Math.min(this.manager.lightMap[this.posX+n][this.posY+e],OUTER_LIGHT);for(var i=-1;i<2;i++)for(var r=-1;r<2;r++)this.manager.lightMap[this.posX+r][this.posY+i]=t>0?Math.min(DEFAULT_LIGHT,INNER_LIGHT+t):Math.min(this.manager.lightMap[this.posX+r][this.posY+i],INNER_LIGHT);this.manager.lightMap[this.posX][this.posY]=t>0?Math.min(DEFAULT_LIGHT,CENTER_LIGHT+t):CENTER_LIGHT}},{key:"chanceToFlicker",value:function(){if(!(Math.random()<.85)){this.lastFlickerCounter=0,this.flickerLength=Math.floor(7*Math.random())+6,this.flickering=!0}}},{key:"flickerLights",value:function(){0===this.flickerCount&&(0===this.flickerToggle?(this.expandLight(.25),this.flickerToggle=1):(this.expandLight(),this.flickerToggle=0)),this.flickerCount++,this.flickerCount>=this.flickerLength&&(this.flickerCount=0,this.flickerTimes++),this.flickerTimes>=6&&(this.flickerTimes=0,this.flickering=!1)}},{key:"tick",value:function(){this.flickering?this.flickerLights():++this.lastFlickerCounter>240&&this.chanceToFlicker()}},{key:"render",value:function(t){t.myDrawImage(this.assets.lantern,this.x-this.handler.getGameCamera().getxOffset(),this.y-this.handler.getGameCamera().getyOffset(),this.width,this.height)}}]),e}(a.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return h});var a=n(0),s=n(5),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=function(t){function e(t,n,o,s,u){i(this,e);var h=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,s,u));return h.assets=a.a.getAssets("tiles"),h.type="exit",h.bounds.x=15,h.bounds.y=15,h.bounds.width=h.width-30,h.bounds.height=h.height-30,h}return o(e,t),u(e,[{key:"tick",value:function(){}},{key:"render",value:function(t){t.myDrawImage(this.assets.exit,this.x-this.handler.getGameCamera().getxOffset(),this.y-this.handler.getGameCamera().getyOffset(),this.width,this.height)}}]),e}(s.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return y});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=document.getElementById("dialogue"),a=document.getElementById("speaker"),s=5,u=0,h="",l="",c=!1,f=[],p=[],y=function(){function t(){i(this,t)}return r(t,[{key:"tick",value:function(){s>=2&&f.length&&(f[0].length?this.speakNextLetter():u>=90?this.resetForNextSentence():u++),s<30&&s++}},{key:"resetForNextSentence",value:function(){f.splice(0,1),p.splice(0,1),this.clean()}},{key:"clean",value:function(){o.innerHTML="",a.innerHTML="",u=0}},{key:"speakNextLetter",value:function(){a.innerHTML=p[0]+":";var t=f[0][0];c="@"===t?!c:c,h=c?'<span style="color:red">':"",l=c?"</span>":"",o.innerHTML+=h+t.replace("@","")+l,f[0].splice(0,1),s=0}},{key:"addWords",value:function(t,e){f.push(e.split("")),p.push(t)}},{key:"clear",value:function(){f=[],p=[],this.clean()}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return u});var a=(n(0),n(5)),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function(t){function e(t,n,o,a,s,u){i(this,e);var h=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,a,s));return h.type="journal",h.bounds.x=10,h.bounds.y=5,h.bounds.width=h.width-30,h.bounds.height=h.height-20,h.journal=u,h.triggered=!1,h}return o(e,t),s(e,[{key:"tick",value:function(){}},{key:"render",value:function(t){var e=this.bounds.x+this.x-this.handler.getGameCamera().getxOffset(),n=this.bounds.y+this.y-this.handler.getGameCamera().getyOffset();t.fillStyle=Math.random()<.5?"white":"brown",t.fillRect(e,n,this.bounds.width,this.bounds.height),t.fillStyle="black",t.strokeRect(e,n,this.bounds.width,this.bounds.height);for(var i=8;i<40;i+=8)t.fillRect(e,n+i,this.width-30,2)}},{key:"triggerEntry",value:function(){var t=this;this.triggered||(this.triggered=!0,this.journal.getText().forEach(function(e){t.handler.getWorld().dialogue.addWords(t.journal.name,e)}))}}]),e}(a.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return u});var a=n(3),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function(t){function e(){i(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.setText(t.myText()),t.name="Entry 1",t}return o(e,t),s(e,[{key:"myText",value:function(){return["I've stayed alive longer than anyone else. Even with this broken leg.","The grotesque beings down here will poison your mind.","They are slow. The rotating walls help cut them off..."]}}]),e}(a.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return u});var a=n(3),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function(t){function e(){i(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.setText(t.myText()),t.name="Entry 2",t}return o(e,t),s(e,[{key:"myText",value:function(){return["It seems like this place gets larger with each floor I descend. Am I in a pyramid?","I am feeling migraines and hearing an eerie voice.","These creatures seem somehow familiar.","(At the bottom of the page you see these words written in @blood@.)","@... ~HeHe. VeRy GooD!~@"]}}]),e}(a.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return u});var a=n(3),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function(t){function e(){i(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.setText(t.myText()),t.name="Entry oo3",t}return o(e,t),s(e,[{key:"myText",value:function(){return["(This page is covered in sweat and droplets of @blood@)","These creatures all have the same familiar face.","@~eVeRy.~","~SiNGLe.~","~oNe.~@","If you've made it this far, I fear no help is available to you.","@~you aRe aLoNe!~@","These headaches are relentless.","~@%#**%*!%%!!!~~@"]}}]),e}(a.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return u});var a=n(3),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function(t){function e(){i(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.setText(t.myText()),t.name="~HEhe EnTRy~",t}return o(e,t),s(e,[{key:"myText",value:function(){return["@~WoW. you MaDe iT To THe eND. WHaT a ViLe JoKe aWaiTS.~","~aT THe eND oF THiS FlooR, i HaVE SeeN THE ANSweR?????~","~SCuRRy oN LiTTLe RaT! you WiLL LeaRN THe TRuTH.~@"]}}]),e}(a.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e,n,r){i(this,t),this.xOffset=n,this.yOffset=r,this.handler=e}return r(t,[{key:"centerOnEntity",value:function(t){this.xOffset=t.getX()-this.handler.getWidth()/2+t.getWidth()/2,this.yOffset=t.getY()-this.handler.getHeight()/2+t.getHeight()/2,this.checkBlankSpace()}},{key:"move",value:function(t,e){this.xOffset+=t,this.yOffset+=e,this.checkBlankSpace()}},{key:"getxOffset",value:function(){return parseInt(this.xOffset)}},{key:"getyOffset",value:function(){return parseInt(this.yOffset)}},{key:"setxOffset",value:function(t){this.xOffset=t}},{key:"setyOffset",value:function(t){this.yOffset=t}},{key:"checkBlankSpace",value:function(){this.xOffset<0?this.xOffset=0:this.xOffset>this.handler.getWorld().getWidth()*TILE_WIDTH-this.handler.getWidth()&&(this.xOffset=this.handler.getWorld().getWidth()*TILE_WIDTH-this.handler.getWidth()),this.yOffset<0?this.yOffset=0:this.yOffset>this.handler.getWorld().getHeight()*TILE_HEIGHT-this.handler.getHeight()&&(this.yOffset=this.handler.getWorld().getHeight()*TILE_HEIGHT-this.handler.getHeight())}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=void 0,a=function(){function t(e){i(this,t),this.game=e}return r(t,[{key:"getWidth",value:function(){return this.game.getWidth()}},{key:"getHeight",value:function(){return this.game.getHeight()}},{key:"getKeyManager",value:function(){return this.game.getKeyManager()}},{key:"getGameCamera",value:function(){return this.game.getGameCamera()}},{key:"getWorld",value:function(){return this.world}},{key:"setWorld",value:function(t){this.world=t}},{key:"getGame",value:function(){return this.game}},{key:"getSM",value:function(){return o}},{key:"setSM",value:function(t){o=t}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=[],a=function(){function t(){i(this,t)}return r(t,[{key:"tick",value:function(){this.up=o[38],this.down=o[40],this.left=o[37],this.right=o[39],this.a=o[65],this.w=o[87],this.s=o[83],this.d=o[68],this.z=o[90],this.q=o[81],this.enter=o[13]}}]),t}();window.onkeydown=function(t){o[t.keyCode]=!0},window.onkeyup=function(t){o[t.keyCode]=!1}},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(6),s=n(4),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)};!function(t){function e(t){return i(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}o(e,t),u(e,[{key:"render",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t,["You are","alone alone alone","aloNe AloNE ALONe","press enter..."])}},{key:"getInput",value:function(){if(this.handler.getKeyManager().enter){var t=new a.a(this.handler);this.handler.getGame().getGameState().setState(t)}}}])}(s.a)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e){i(this,t),this.currentState=null,this.handler=e}return r(t,[{key:"getState",value:function(){return this.currentState}},{key:"setState",value:function(t){this.currentState=t}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return s});var r=n(44),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a={},s=function(){function t(){i(this,t),this.loaded=!1,this.lastTime=0,this.logged=0,this.init()}return o(t,[{key:"init",value:function(){a={bg:this.create(.3,"bg",!0,{songData:[{i:[3,59,140,0,1,60,128,3,0,29,92,28,95,0,0,3,96,2,1,2,124,135,11,25,130,4,97,2],p:[1],c:[{n:[112,,,,114,,,,117,,,,114,,,,112,,,,114,,,,117,,,,114,,,,141,,,,,,,,,,,,,,,,138],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]}],rowLen:22050,patternLen:32,endPattern:2}),wall:this.create(.6,"wall",!1,{songData:[{i:[3,61,128,0,3,55,140,0,0,127,29,27,27,0,0,2,0,3,1,3,14,79,14,28,0,2,0,0],p:[1],c:[{n:[99,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,99],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]}],rowLen:22050,patternLen:32,endPattern:2})}}},{key:"play",value:function(t){a[t]&&(a[t].load(),a[t].play())}},{key:"create",value:function(t,e,n,i){var o=new r.a;o.init(i);var s=!1,u=setInterval(function(e){if(!s&&(s=o.generate()>=1)){var i=o.createWave(),r=document.createElement("audio");r.src=URL.createObjectURL(new Blob([i],{type:"audio/wav"})),r.volume=t,n&&(r.loop=!0,r.play()),a[e]=r,clearInterval(u)}},0,e,t)}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){var t=function(t){return Math.sin(6.283184*t)},e=function(t){return t%1*2-1},n=function(t){return t%1<.5?1:-1},i=function(t){var e=t%1*4;return e<2?e-1:3-e},r=function(t){return.003959503758*Math.pow(2,(t-128)/12)},o=function(t,e,n){var i=a[t.i[0]],o=t.i[1],s=t.i[3],u=a[t.i[4]],h=t.i[5],l=t.i[8],c=t.i[9],f=t.i[10]*t.i[10]*4,p=t.i[11]*t.i[11]*4,y=t.i[12]*t.i[12]*4,d=1/y,g=t.i[13],v=n*Math.pow(2,2-t.i[14]),b=new Int32Array(f+p+y),w=0,m=0,k=void 0,T=void 0,_=void 0,O=void 0,E=void 0,I=void 0,x=void 0;for(k=0,T=0;k<f+p+y;k++,T++)T>=0&&(g=g>>8|(255&g)<<4,T-=v,I=r(e+(15&g)+t.i[2]-128),x=r(e+(15&g)+t.i[6]-128)*(1+8e-4*t.i[7])),_=1,k<f?_=k/f:k>=f+p&&(_-=(k-f-p)*d),O=I,s&&(O*=_*_),w+=O,E=i(w)*o,O=x,l&&(O*=_*_),m+=O,E+=u(m)*h,c&&(E+=(2*Math.random()-1)*c),b[k]=80*E*_|0;return b},a=[t,n,e,i],s=void 0,u=void 0,h=void 0,l=void 0,c=void 0;this.init=function(t){s=t,u=t.endPattern-2,h=0,l=t.rowLen*t.patternLen*(u+1)*2,c=new Int32Array(l)},this.generate=function(){var e=void 0,n=void 0,i=void 0,r=void 0,f=void 0,p=void 0,y=void 0,d=void 0,g=void 0,v=void 0,b=void 0,w=void 0,m=new Int32Array(l),k=s.songData[h],T=s.rowLen,_=s.patternLen,O=0,E=0,I=void 0,x=void 0,M=!1,j=[];for(i=0;i<=u;++i)for(y=k.p[i],r=0;r<_;++r){var H=y?k.c[y-1].f[r]:0;H&&(k.i[H-1]=k.c[y-1].f[r+_]||0,H<16&&(j=[]));var L=a[k.i[15]],P=k.i[16]/512,W=Math.pow(2,k.i[17]-9)/T,C=k.i[18],S=k.i[19],G=43.23529*k.i[20]*3.141592/44100,D=1-k.i[21]/255,R=1e-5*k.i[22],A=k.i[23]/32,z=k.i[24]/512,F=6.283184*Math.pow(2,k.i[25]-9)/T,Y=k.i[26]/255,N=k.i[27]*T;for(b=(i*_+r)*T,f=0;f<4;++f)if(p=y?k.c[y-1].n[r+f*_]:0){j[p]||(j[p]=o(k,p,T));var X=j[p];for(n=0,e=2*b;n<X.length;n++,e+=2)m[e]+=X[n]}for(n=0;n<T;n++)d=2*(b+n),v=m[d],v||M?(w=G,C&&(w*=L(W*d)*P+.5),w=1.5*Math.sin(w),O+=w*E,I=D*(v-E)-O,E+=w*I,v=3==S?E:1==S?I:O,R&&(v*=R,v=v<1?v>-1?t(.25*v):-1:1,v/=R),v*=A,M=v*v>1e-5,g=Math.sin(F*d)*z+.5,x=v*(1-g),v*=g):x=0,d>=N&&(x+=m[d-N+1]*Y,v+=m[d-N]*Y),m[d]=0|x,m[d+1]=0|v,c[d]+=0|x,c[d+1]+=0|v}return++h/8},this.createWave=function(){var t=44+2*l-8,e=t-36,n=new Uint8Array(44+2*l);n.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var i=0,r=44;i<l;++i){var o=c[i];o=o<-32767?-32767:o>32767?32767:o,n[r++]=255&o,n[r++]=o>>8&255}return n}}},function(t,e){}]);</script></body>

</html>
